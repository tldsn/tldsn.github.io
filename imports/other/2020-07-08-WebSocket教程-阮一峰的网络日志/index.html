<!DOCTYPE html>
<html>

<head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">

    <title>WebSocket教程-阮一峰的网络日志</title>
    <meta name="description" content="                                       WebSocket 教程                                            ">

    <link rel="shortcut icon" href="/favicon.ico?" type="image/x-icon">
    <link rel="icon" href="/favicon.ico?" type="image/x-icon">
    <link rel="stylesheet" href="https://cdn.bootcss.com/font-awesome/4.7.0/css/font-awesome.min.css">
    <!-- <script src="https://kit.fontawesome.com/bff30092be.js" crossorigin="anonymous"></script> -->
    <link rel="stylesheet" href="https://at.alicdn.com/t/font_1096581_7o3r6v7yzsh.css">
    <link rel="stylesheet" href="/assets/css/main.css ">
    <link rel="canonical" href="http://localhost:4000/imports/other/2020-07-08-WebSocket%E6%95%99%E7%A8%8B-%E9%98%AE%E4%B8%80%E5%B3%B0%E7%9A%84%E7%BD%91%E7%BB%9C%E6%97%A5%E5%BF%97/">
    <link rel="alternate" type="application/rss+xml" title="TLDSN" href="http://localhost:4000/feed.xml ">
    <link type="application/atom+xml" rel="alternate" href="http://localhost:4000/feed.xml" title="TLDSN" />
    <!-- Begin Jekyll SEO tag v2.6.1 -->
<title>WebSocket教程-阮一峰的网络日志 | TLDSN</title>
<meta name="generator" content="Jekyll v4.0.0" />
<meta property="og:title" content="WebSocket教程-阮一峰的网络日志" />
<meta name="author" content="tldsn" />
<meta property="og:locale" content="en_US" />
<meta name="description" content="WebSocket 教程" />
<meta property="og:description" content="WebSocket 教程" />
<link rel="canonical" href="http://localhost:4000/imports/other/2020-07-08-WebSocket%E6%95%99%E7%A8%8B-%E9%98%AE%E4%B8%80%E5%B3%B0%E7%9A%84%E7%BD%91%E7%BB%9C%E6%97%A5%E5%BF%97/" />
<meta property="og:url" content="http://localhost:4000/imports/other/2020-07-08-WebSocket%E6%95%99%E7%A8%8B-%E9%98%AE%E4%B8%80%E5%B3%B0%E7%9A%84%E7%BD%91%E7%BB%9C%E6%97%A5%E5%BF%97/" />
<meta property="og:site_name" content="TLDSN" />
<meta property="og:type" content="article" />
<meta property="article:published_time" content="2020-07-08T00:00:00+08:00" />
<script type="application/ld+json">
{"url":"http://localhost:4000/imports/other/2020-07-08-WebSocket%E6%95%99%E7%A8%8B-%E9%98%AE%E4%B8%80%E5%B3%B0%E7%9A%84%E7%BD%91%E7%BB%9C%E6%97%A5%E5%BF%97/","author":{"@type":"Person","name":"tldsn"},"description":"WebSocket 教程","dateModified":"2020-07-08T00:00:00+08:00","datePublished":"2020-07-08T00:00:00+08:00","headline":"WebSocket教程-阮一峰的网络日志","@type":"BlogPosting","mainEntityOfPage":{"@type":"WebPage","@id":"http://localhost:4000/imports/other/2020-07-08-WebSocket%E6%95%99%E7%A8%8B-%E9%98%AE%E4%B8%80%E5%B3%B0%E7%9A%84%E7%BD%91%E7%BB%9C%E6%97%A5%E5%BF%97/"},"@context":"https://schema.org"}</script>
<!-- End Jekyll SEO tag -->


    <script>
    // 百度统计代码
    var _hmt = _hmt || [];
    (function() {
      var hm = document.createElement("script");
      hm.src = "//hm.baidu.com/hm.js?ccd4104a124f2218d64c124431d52789";
      var s = document.getElementsByTagName("script")[0];
      s.parentNode.insertBefore(hm, s);
    })();
    </script>


    <script>
    // google analytics
      (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
      (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
      m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
      })(window,document,'script','https://www.google-analytics.com/analytics.js','ga');

      ga('create', 'UA-163446273-1', 'auto');
      ga('send', 'pageview');

    </script>



</head>


<body>

  <header id="top">
    <div class="wrapper">
        <a href="/" class="brand">TLDSN</a>
        <small>太阳升起时，请重新开始</small>
        <button id="headerMenu" class="menu"><i class="fa fa-bars"></i></button>
        <nav id="headerNav">
            <ul>
                <li>
                    
                    <a href="/">
                    
                        <i class="fa fa-home"></i>Home
                    </a>
                </li>

                
                    
                    <li>
                        
                        <a href="/archive/">
                        
                            <i class="fa fa-archive"></i>Archives
                        </a>
                    </li>
                    
                
                    
                    <li>
                        
                        <a href="/category/">
                        
                            <i class="fa fa-th-list"></i>Categories
                        </a>
                    </li>
                    
                
                    
                    <li>
                        
                        <a href="/tag/">
                        
                            <i class="fa fa-tags"></i>Tags
                        </a>
                    </li>
                    
                
                    
                    <li>
                        
                        <a href="/collection/">
                        
                            <i class="fa fa-bookmark"></i>Collections
                        </a>
                    </li>
                    
                
                    
                
                    
                    <li>
                        
                        <a href="/todo/">
                        
                            <i class="fa fa-check-square-o"></i>Todo
                        </a>
                    </li>
                    
                
                    
                    <li>
                        
                        <a href="/note/">
                        
                            <i class="fa fa-code"></i>Note
                        </a>
                    </li>
                    
                
                    
                    <li>
                        
                        <a href="/about/">
                        
                            <i class="fa fa-heart"></i>About
                        </a>
                    </li>
                    
                
                    
                    <li>
                        
                        <a href="/authors/">
                        
                            <i class="fa fa-id-card-o"></i>Staff
                        </a>
                    </li>
                    
                
                    
                    <li>
                        
                        <a href="/evernote/">
                        
                            <i class="fa fa-reply-all"></i>evernote
                        </a>
                    </li>
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
            </ul>
        </nav>
    </div>
</header>


  <div class="page clearfix" post>
  <div class="left">    
      <html><head></head><body><div class="ennote">
  <div style="--en-clipped-content:article">
<div><br></div><div style="font-size: 16px; display:block; min-width: 100%; position: relative;"> <div style="list-style-type:none;text-align:left;text-decoration:none;font-weight:normal;font-style:normal;color:rgb(17, 17, 17);"><div style="list-style-type:none;text-align:left;text-decoration:none;font-weight:normal;font-style:normal;font-family:Georgia, serif;letter-spacing:-0.01em;word-spacing:0.2em;line-height:1.8em;font-size:62.5%;background-color:rgb(245, 245, 213);color:rgb(17, 17, 17);"><div style="list-style-type:none;text-align:left;text-decoration:none;font-weight:normal;font-style:normal;color:rgb(17, 17, 17);background-color:rgb(245, 245, 213);min-width:640px;"><div style="list-style-type:none;text-align:left;text-decoration:none;font-weight:normal;font-style:normal;color:rgb(17, 17, 17);"><div style="list-style-type:none;text-align:left;text-decoration:none;font-weight:normal;font-style:normal;color:rgb(17, 17, 17);"><div style="list-style-type:none;text-align:left;text-decoration:none;font-weight:normal;font-style:normal;color:rgb(17, 17, 17);"><div style="list-style-type:none;text-align:left;text-decoration:none;font-weight:normal;font-style:normal;color:rgb(17, 17, 17);"><div style="list-style-type:none;text-align:left;text-decoration:none;font-weight:normal;font-style:normal;color:rgb(17, 17, 17);"><div style="list-style-type:none;text-align:left;text-decoration:none;font-weight:normal;font-style:normal;color:rgb(17, 17, 17);"><div>
                                    <h1 style="list-style-type:none;text-align:left;text-decoration:none;font-style:normal;border:medium none;font-size:2.88em;letter-spacing:-0.03em;border-bottom:1px solid rgb(211, 211, 211);margin:0.4em 0px 0.2em;padding:0px 0px 0.2em;font-weight:500;color:rgb(0, 0, 0);line-height:250%;font-family:&quot;Trebuchet MS&quot;, Arial, &quot;Lucida Grande&quot;, Verdana, Lucida, Helvetica, sans-serif;">WebSocket 教程</h1>
                                            <div style="margin:0px;padding:0px;list-style-type:none;text-align:left;text-decoration:none;font-weight:normal;font-style:normal;border:medium none;color:rgb(17, 17, 17);float:right;padding-right:2em;padding-top:1em;">
<a href="http://www.bshare.cn/share" style="margin:0px;padding:0px;list-style-type:none;text-align:left;text-decoration:none;font-weight:normal;font-style:normal;background:rgba(0, 0, 0, 0) none repeat scroll 0% 0%;font:12px / 14px Helvetica, Calibri, Tahoma, Arial, 宋体, sans-serif;border:medium none;overflow:hidden;color:rgb(85, 102, 119);height:21px;line-height:18px;font-size:12px;padding-left:0px;display:block;width:51px;"><div style="list-style-type:none;margin:0px;padding:0px;text-align:center;font-style:normal;text-decoration:none;font-weight:bold;border:medium none;color:#333;display:inline-block;background:transparent url(http://static.bshare.cn/frame/images/button_custom10-zh-Orange.gif) no-repeat;line-height:1.2;cursor:pointer;height:21px;width:51px;"></div><div style="list-style-type:none;text-align:left;font-weight:normal;font-style:normal;color:rgb(17, 17, 17);display:inline-block;background:rgba(0, 0, 0, 0) none repeat scroll 0% 0%;line-height:1.2;margin:0px;padding:0px;text-decoration:none;border:medium none;clear:both;"></div></a>





</div>

<div style="padding:0px;list-style-type:none;text-align:left;text-decoration:none;font-weight:normal;font-style:normal;border:medium none;color:rgb(17, 17, 17);line-height:0.8;margin:1.5em auto 2em;">
                                        

                                            <p style="margin:0px;padding:0px;list-style-type:none;text-align:left;text-decoration:none;font-weight:normal;font-style:normal;border:medium none;font-size:1.6em;margin-top:1em;margin-left:0.8em;line-height:180%;color:rgb(85, 102, 119);">作者： <a href="http://www.ruanyifeng.com/" style="margin:0px;padding:0px;list-style-type:none;text-align:left;text-decoration:none;font-weight:normal;font-style:normal;border:medium none;color:rgb(85, 102, 119);">阮一峰</a></p>
                                    <p style="margin:0px;padding:0px;list-style-type:none;text-align:left;text-decoration:none;font-weight:normal;font-style:normal;border:medium none;font-size:1.6em;margin-top:1em;margin-left:0.8em;line-height:180%;color:rgb(85, 102, 119);">日期： <a href="http://www.ruanyifeng.com/blog/2017/05/" style="margin:0px;padding:0px;list-style-type:none;text-align:left;text-decoration:none;font-weight:normal;font-style:normal;border:medium none;color:rgb(85, 102, 119);"><abbr title="2017-05-15T08:39:57+08:00" style="margin:0px;padding:0px;list-style-type:none;text-align:left;text-decoration:none;font-weight:normal;font-style:normal;border:medium none;color:rgb(85, 102, 119);">2017年5月15日</abbr></a></p>


</div>








                                
                                <div style="margin:0px;padding:0px;list-style-type:none;text-align:left;text-decoration:none;font-weight:normal;font-style:normal;border:medium none;color:rgb(17, 17, 17);">

                                    
                                        <p style="margin:0px;padding:0px;list-style-type:none;text-align:left;text-decoration:none;font-weight:normal;font-style:normal;border:medium none;color:rgb(17, 17, 17);font-size:1.6em;margin-top:1em;margin-left:0.8em;line-height:180%;"><a href="http://websocket.org/" target="_blank" style="margin:0px;padding:0px;list-style-type:none;text-align:left;font-weight:normal;font-style:normal;border:medium none;text-decoration:underline;color:rgb(34, 52, 114);">WebSocket</a> 是一种网络通信协议，很多高级功能都需要它。</p>

                                    


                                    
                                        <p style="margin:0px;padding:0px;list-style-type:none;text-align:left;text-decoration:none;font-weight:normal;font-style:normal;border:medium none;color:rgb(17, 17, 17);font-size:1.6em;margin-top:1em;margin-left:0.8em;line-height:180%;">本文介绍 WebSocket 协议的使用方法。</p>

<p style="margin:0px;padding:0px;list-style-type:none;text-align:left;text-decoration:none;font-weight:normal;font-style:normal;border:medium none;color:rgb(17, 17, 17);font-size:1.6em;margin-top:1em;margin-left:0.8em;line-height:180%;"><img title="" width="400" height="156" style="margin:0px;padding:0px;list-style-type:none;text-align:left;text-decoration:none;font-weight:normal;font-style:normal;color:rgb(17, 17, 17);border-radius:1em;border:0.3em solid rgb(224, 223, 204);" src="https://app.yinxiang.com/files/common-services/binary-datas/c2VydmljZVR5cGU9MiZzZXJ2aWNlRGF0YT17Im5vdGVHdWlkIjoiOTk1YTQ0NjgtZDliMi00MGFiLTg2NTEtNmFjNTE3ODA4MWVmIiwicmVzb3VyY0d1aWQiOiJjODUxMmM2MC0wMmQxLTRlNzItYmI5Yy1iMTA4YjFjNTEzNWQifQ==" data-original-width="400" mime="image/png" data-original-height="156" id="e6911b1960bc223c913a9197efeb2389" class="en-media"></p>

<h2 style="list-style-type:none;text-align:left;text-decoration:none;font-style:normal;border:medium none;font-size:2.88em;line-height:1.35em;letter-spacing:-0.03em;border-bottom:1px solid rgb(211, 211, 211);margin:0.4em 0px 0.2em;padding:0px 0px 0.2em;font-weight:500;color:rgb(0, 0, 0);margin-top:1.5em;">一、为什么需要 WebSocket？</h2>

<p style="margin:0px;padding:0px;list-style-type:none;text-align:left;text-decoration:none;font-weight:normal;font-style:normal;border:medium none;color:rgb(17, 17, 17);font-size:1.6em;margin-top:1em;margin-left:0.8em;line-height:180%;">初次接触 WebSocket 的人，都会问同样的问题：我们已经有了 HTTP 协议，为什么还需要另一个协议？它能带来什么好处？</p>

<p style="margin:0px;padding:0px;list-style-type:none;text-align:left;text-decoration:none;font-weight:normal;font-style:normal;border:medium none;color:rgb(17, 17, 17);font-size:1.6em;margin-top:1em;margin-left:0.8em;line-height:180%;">答案很简单，因为 HTTP 协议有一个缺陷：通信只能由客户端发起。</p>

<p style="margin:0px;padding:0px;list-style-type:none;text-align:left;text-decoration:none;font-weight:normal;font-style:normal;border:medium none;color:rgb(17, 17, 17);font-size:1.6em;margin-top:1em;margin-left:0.8em;line-height:180%;">举例来说，我们想了解今天的天气，只能是客户端向服务器发出请求，服务器返回查询结果。HTTP 协议做不到服务器主动向客户端推送信息。</p>

<p style="margin:0px;padding:0px;list-style-type:none;text-align:left;text-decoration:none;font-weight:normal;font-style:normal;border:medium none;color:rgb(17, 17, 17);font-size:1.6em;margin-top:1em;margin-left:0.8em;line-height:180%;"><img title="" width="638" height="479" style="margin:0px;padding:0px;list-style-type:none;text-align:left;text-decoration:none;font-weight:normal;font-style:normal;color:rgb(17, 17, 17);border-radius:1em;border:0.3em solid rgb(224, 223, 204);" src="https://app.yinxiang.com/files/common-services/binary-datas/c2VydmljZVR5cGU9MiZzZXJ2aWNlRGF0YT17Im5vdGVHdWlkIjoiOTk1YTQ0NjgtZDliMi00MGFiLTg2NTEtNmFjNTE3ODA4MWVmIiwicmVzb3VyY0d1aWQiOiI1Y2FlZjU5Yi02ZmNmLTQ0NWUtOTFhNy1iZmNjN2M0OGFiMzUifQ==" data-original-width="638" mime="image/png" data-original-height="479" id="aa997c04878aeb878bf336e060f0b270" class="en-media"></p>

<p style="margin:0px;padding:0px;list-style-type:none;text-align:left;text-decoration:none;font-weight:normal;font-style:normal;border:medium none;color:rgb(17, 17, 17);font-size:1.6em;margin-top:1em;margin-left:0.8em;line-height:180%;">这种单向请求的特点，注定了如果服务器有连续的状态变化，客户端要获知就非常麻烦。我们只能使用<a href="https://www.pubnub.com/blog/2014-12-01-http-long-polling/" target="_blank" style="margin:0px;padding:0px;list-style-type:none;text-align:left;font-weight:normal;font-style:normal;border:medium none;text-decoration:underline;color:rgb(34, 52, 114);">"轮询"</a>：每隔一段时候，就发出一个询问，了解服务器有没有新的信息。最典型的场景就是聊天室。</p>

<p style="margin:0px;padding:0px;list-style-type:none;text-align:left;text-decoration:none;font-weight:normal;font-style:normal;border:medium none;color:rgb(17, 17, 17);font-size:1.6em;margin-top:1em;margin-left:0.8em;line-height:180%;">轮询的效率低，非常浪费资源（因为必须不停连接，或者 HTTP 连接始终打开）。因此，工程师们一直在思考，有没有更好的方法。WebSocket 就是这样发明的。</p>

<h2 style="list-style-type:none;text-align:left;text-decoration:none;font-style:normal;border:medium none;font-size:2.88em;line-height:1.35em;letter-spacing:-0.03em;border-bottom:1px solid rgb(211, 211, 211);margin:0.4em 0px 0.2em;padding:0px 0px 0.2em;font-weight:500;color:rgb(0, 0, 0);margin-top:1.5em;">二、简介</h2>

<p style="margin:0px;padding:0px;list-style-type:none;text-align:left;text-decoration:none;font-weight:normal;font-style:normal;border:medium none;color:rgb(17, 17, 17);font-size:1.6em;margin-top:1em;margin-left:0.8em;line-height:180%;">WebSocket 协议在2008年诞生，2011年成为国际标准。所有浏览器都已经支持了。</p>

<p style="margin:0px;padding:0px;list-style-type:none;text-align:left;text-decoration:none;font-weight:normal;font-style:normal;border:medium none;color:rgb(17, 17, 17);font-size:1.6em;margin-top:1em;margin-left:0.8em;line-height:180%;">它的最大特点就是，服务器可以主动向客户端推送信息，客户端也可以主动向服务器发送信息，是真正的双向平等对话，属于<a href="https://en.wikipedia.org/wiki/Push_technology" target="_blank" style="margin:0px;padding:0px;list-style-type:none;text-align:left;font-weight:normal;font-style:normal;border:medium none;text-decoration:underline;color:rgb(34, 52, 114);">服务器推送技术</a>的一种。</p>

<p style="margin:0px;padding:0px;list-style-type:none;text-align:left;text-decoration:none;font-weight:normal;font-style:normal;border:medium none;color:rgb(17, 17, 17);font-size:1.6em;margin-top:1em;margin-left:0.8em;line-height:180%;"><img title="" width="628" height="511" style="margin:0px;padding:0px;list-style-type:none;text-align:left;text-decoration:none;font-weight:normal;font-style:normal;color:rgb(17, 17, 17);border-radius:1em;border:0.3em solid rgb(224, 223, 204);" src="https://app.yinxiang.com/files/common-services/binary-datas/c2VydmljZVR5cGU9MiZzZXJ2aWNlRGF0YT17Im5vdGVHdWlkIjoiOTk1YTQ0NjgtZDliMi00MGFiLTg2NTEtNmFjNTE3ODA4MWVmIiwicmVzb3VyY0d1aWQiOiI5NDYzNTAyYi05OTM5LTRkNWQtYmIyZC00MDVkMTk4ZjA5ZGQifQ==" data-original-width="628" mime="image/png" data-original-height="511" id="3d2bbd0885aee71026502d64dce6ec81" class="en-media"></p>

<p style="margin:0px;padding:0px;list-style-type:none;text-align:left;text-decoration:none;font-weight:normal;font-style:normal;border:medium none;color:rgb(17, 17, 17);font-size:1.6em;margin-top:1em;margin-left:0.8em;line-height:180%;">其他特点包括：</p>

<p style="margin:0px;padding:0px;list-style-type:none;text-align:left;text-decoration:none;font-weight:normal;font-style:normal;border:medium none;color:rgb(17, 17, 17);font-size:1.6em;margin-top:1em;margin-left:0.8em;line-height:180%;">（1）建立在 TCP 协议之上，服务器端的实现比较容易。</p>

<p style="margin:0px;padding:0px;list-style-type:none;text-align:left;text-decoration:none;font-weight:normal;font-style:normal;border:medium none;color:rgb(17, 17, 17);font-size:1.6em;margin-top:1em;margin-left:0.8em;line-height:180%;">（2）与 HTTP 协议有着良好的兼容性。默认端口也是80和443，并且握手阶段采用 HTTP 协议，因此握手时不容易屏蔽，能通过各种 HTTP 代理服务器。</p>

<p style="margin:0px;padding:0px;list-style-type:none;text-align:left;text-decoration:none;font-weight:normal;font-style:normal;border:medium none;color:rgb(17, 17, 17);font-size:1.6em;margin-top:1em;margin-left:0.8em;line-height:180%;">（3）数据格式比较轻量，性能开销小，通信高效。</p>

<p style="margin:0px;padding:0px;list-style-type:none;text-align:left;text-decoration:none;font-weight:normal;font-style:normal;border:medium none;color:rgb(17, 17, 17);font-size:1.6em;margin-top:1em;margin-left:0.8em;line-height:180%;">（4）可以发送文本，也可以发送二进制数据。</p>

<p style="margin:0px;padding:0px;list-style-type:none;text-align:left;text-decoration:none;font-weight:normal;font-style:normal;border:medium none;color:rgb(17, 17, 17);font-size:1.6em;margin-top:1em;margin-left:0.8em;line-height:180%;">（5）没有同源限制，客户端可以与任意服务器通信。</p>

<p style="margin:0px;padding:0px;list-style-type:none;text-align:left;text-decoration:none;font-weight:normal;font-style:normal;border:medium none;color:rgb(17, 17, 17);font-size:1.6em;margin-top:1em;margin-left:0.8em;line-height:180%;">（6）协议标识符是<code style="padding:0px;list-style-type:none;text-align:left;text-decoration:none;font-weight:normal;font-style:normal;border:medium none;color:rgb(17, 17, 17);display:inline-block;padding-left:5px;padding-right:5px;font-size:120%;background-color:pink;border-radius:5px;margin:auto 3px;">ws</code>（如果加密，则为<code style="padding:0px;list-style-type:none;text-align:left;text-decoration:none;font-weight:normal;font-style:normal;border:medium none;color:rgb(17, 17, 17);display:inline-block;padding-left:5px;padding-right:5px;font-size:120%;background-color:pink;border-radius:5px;margin:auto 3px;">wss</code>），服务器网址就是 URL。</p>

<blockquote style="list-style-type:none;text-align:left;text-decoration:none;font-weight:normal;font-style:normal;border:medium none;color:rgb(17, 17, 17);background-color:rgb(245, 242, 240);border-radius:1em;font-family:Consolas, Monaco, &quot;Andale Mono&quot;, monospace;border-width:0.3em;border-color:rgb(224, 223, 204);border-style:solid;text-shadow:white 0px 1px;overflow:auto;margin:2em;padding:1em;"><pre style="margin:0px;list-style-type:none;text-decoration:none;font-weight:normal;font-style:normal;border:medium none;text-shadow:white 0px 1px;font-family:monospace, Consolas, Monaco, &quot;Andale Mono&quot;;direction:ltr;white-space:pre;word-spacing:normal;font-size:1.2em;hyphens:none;text-align:left;color:black;overflow:auto;padding:0em 0em 0.5em;background:rgb(245, 242, 240) none repeat scroll 0% 0%;" xml:space="preserve"><code style="margin:0px;padding:0px;list-style-type:none;text-decoration:none;font-weight:normal;font-style:normal;border:medium none;text-shadow:white 0px 1px;font-family:monospace, Consolas, Monaco, &quot;Andale Mono&quot;;direction:ltr;white-space:pre;word-spacing:normal;font-size:1.2em;hyphens:none;text-align:left;color:black;">
ws://example.com:80/some/path
</code></pre></blockquote>

<p style="margin:0px;padding:0px;list-style-type:none;text-align:left;text-decoration:none;font-weight:normal;font-style:normal;border:medium none;color:rgb(17, 17, 17);font-size:1.6em;margin-top:1em;margin-left:0.8em;line-height:180%;"><img title="" width="418" height="312" style="margin:0px;padding:0px;list-style-type:none;text-align:left;text-decoration:none;font-weight:normal;font-style:normal;color:rgb(17, 17, 17);border-radius:1em;border:0.3em solid rgb(224, 223, 204);" src="https://app.yinxiang.com/files/common-services/binary-datas/c2VydmljZVR5cGU9MiZzZXJ2aWNlRGF0YT17Im5vdGVHdWlkIjoiOTk1YTQ0NjgtZDliMi00MGFiLTg2NTEtNmFjNTE3ODA4MWVmIiwicmVzb3VyY0d1aWQiOiIzOTI4ZTViNC01OGY3LTRkMmQtOTE1Yi01NWRkMTVkMWU0ZWUifQ==" data-original-width="418" mime="image/png" data-original-height="312" id="00edfc3ec3c358540cb38ca1b594cb34" class="en-media"></p>

<h2 style="list-style-type:none;text-align:left;text-decoration:none;font-style:normal;border:medium none;font-size:2.88em;line-height:1.35em;letter-spacing:-0.03em;border-bottom:1px solid rgb(211, 211, 211);margin:0.4em 0px 0.2em;padding:0px 0px 0.2em;font-weight:500;color:rgb(0, 0, 0);margin-top:1.5em;">三、客户端的简单示例</h2>

<p style="margin:0px;padding:0px;list-style-type:none;text-align:left;text-decoration:none;font-weight:normal;font-style:normal;border:medium none;color:rgb(17, 17, 17);font-size:1.6em;margin-top:1em;margin-left:0.8em;line-height:180%;">WebSocket 的用法相当简单。</p>

<p style="margin:0px;padding:0px;list-style-type:none;text-align:left;text-decoration:none;font-weight:normal;font-style:normal;border:medium none;color:rgb(17, 17, 17);font-size:1.6em;margin-top:1em;margin-left:0.8em;line-height:180%;">下面是一个网页脚本的例子（点击<a href="http://jsbin.com/muqamiqimu/edit?js,console" target="_blank" style="margin:0px;padding:0px;list-style-type:none;text-align:left;font-weight:normal;font-style:normal;border:medium none;text-decoration:underline;color:rgb(34, 52, 114);">这里</a>看运行结果），基本上一眼就能明白。</p>

<blockquote style="list-style-type:none;text-align:left;text-decoration:none;font-weight:normal;font-style:normal;border:medium none;color:rgb(17, 17, 17);background-color:rgb(245, 242, 240);border-radius:1em;font-family:Consolas, Monaco, &quot;Andale Mono&quot;, monospace;border-width:0.3em;border-color:rgb(224, 223, 204);border-style:solid;text-shadow:white 0px 1px;overflow:auto;margin:2em;padding:1em;"><pre style="margin:0px;list-style-type:none;text-decoration:none;font-weight:normal;font-style:normal;border:medium none;text-shadow:white 0px 1px;font-family:monospace, Consolas, Monaco, &quot;Andale Mono&quot;;direction:ltr;white-space:pre;word-spacing:normal;font-size:1.2em;hyphens:none;text-align:left;color:black;overflow:auto;padding:0em 0em 0.5em;background:rgb(245, 242, 240) none repeat scroll 0% 0%;" xml:space="preserve"><code style="margin:0px;padding:0px;list-style-type:none;text-decoration:none;font-weight:normal;font-style:normal;border:medium none;text-shadow:white 0px 1px;font-family:monospace, Consolas, Monaco, &quot;Andale Mono&quot;;direction:ltr;white-space:pre;word-spacing:normal;font-size:1.2em;hyphens:none;text-align:left;color:black;">
<span style="margin:0px;padding:0px;list-style-type:none;text-align:left;text-decoration:none;font-weight:normal;font-style:normal;border:medium none;color:rgb(0, 119, 170);">var</span> ws <span style="margin:0px;padding:0px;list-style-type:none;text-align:left;text-decoration:none;font-weight:normal;font-style:normal;border:medium none;background:rgba(255, 255, 255, 0.5) none repeat scroll 0% 0%;color:rgb(166, 127, 89);background-color:rgb(204, 232, 207);">=</span> <span style="margin:0px;padding:0px;list-style-type:none;text-align:left;text-decoration:none;font-weight:normal;font-style:normal;border:medium none;color:rgb(0, 119, 170);">new</span> <span style="margin:0px;padding:0px;list-style-type:none;text-align:left;text-decoration:none;font-weight:normal;font-style:normal;border:medium none;color:rgb(17, 17, 17);">WebSocket</span><span style="margin:0px;padding:0px;list-style-type:none;text-align:left;text-decoration:none;font-weight:normal;font-style:normal;border:medium none;color:rgb(153, 153, 153);">(</span><span style="margin:0px;padding:0px;list-style-type:none;text-align:left;text-decoration:none;font-weight:normal;font-style:normal;border:medium none;color:rgb(102, 153, 0);">"<a href="http://www.ruanyifeng.com/blog/2017/05/websocket.htmlwss://echo.websocket.org/" style="margin:0px;padding:0px;list-style-type:none;text-align:left;font-weight:normal;font-style:normal;border:medium none;text-decoration:underline;color:rgb(34, 52, 114);">wss://echo.websocket.org</a>"</span><span style="margin:0px;padding:0px;list-style-type:none;text-align:left;text-decoration:none;font-weight:normal;font-style:normal;border:medium none;color:rgb(153, 153, 153);">)</span><span style="margin:0px;padding:0px;list-style-type:none;text-align:left;text-decoration:none;font-weight:normal;font-style:normal;border:medium none;color:rgb(153, 153, 153);">;</span>

ws<span style="margin:0px;padding:0px;list-style-type:none;text-align:left;text-decoration:none;font-weight:normal;font-style:normal;border:medium none;color:rgb(153, 153, 153);">.</span>onopen <span style="margin:0px;padding:0px;list-style-type:none;text-align:left;text-decoration:none;font-weight:normal;font-style:normal;border:medium none;background:rgba(255, 255, 255, 0.5) none repeat scroll 0% 0%;color:rgb(166, 127, 89);background-color:rgb(204, 232, 207);">=</span> <span style="margin:0px;padding:0px;list-style-type:none;text-align:left;text-decoration:none;font-weight:normal;font-style:normal;border:medium none;color:rgb(0, 119, 170);">function</span><span style="margin:0px;padding:0px;list-style-type:none;text-align:left;text-decoration:none;font-weight:normal;font-style:normal;border:medium none;color:rgb(153, 153, 153);">(</span>evt<span style="margin:0px;padding:0px;list-style-type:none;text-align:left;text-decoration:none;font-weight:normal;font-style:normal;border:medium none;color:rgb(153, 153, 153);">)</span> <span style="margin:0px;padding:0px;list-style-type:none;text-align:left;text-decoration:none;font-weight:normal;font-style:normal;border:medium none;color:rgb(153, 153, 153);">{</span> 
  console<span style="margin:0px;padding:0px;list-style-type:none;text-align:left;text-decoration:none;font-weight:normal;font-style:normal;border:medium none;color:rgb(153, 153, 153);">.</span><span style="margin:0px;padding:0px;list-style-type:none;text-align:left;text-decoration:none;font-weight:normal;font-style:normal;border:medium none;color:rgb(17, 17, 17);">log<span style="margin:0px;padding:0px;list-style-type:none;text-align:left;text-decoration:none;font-weight:normal;font-style:normal;border:medium none;color:rgb(153, 153, 153);">(</span></span><span style="margin:0px;padding:0px;list-style-type:none;text-align:left;text-decoration:none;font-weight:normal;font-style:normal;border:medium none;color:rgb(102, 153, 0);">"Connection open ..."</span><span style="margin:0px;padding:0px;list-style-type:none;text-align:left;text-decoration:none;font-weight:normal;font-style:normal;border:medium none;color:rgb(153, 153, 153);">)</span><span style="margin:0px;padding:0px;list-style-type:none;text-align:left;text-decoration:none;font-weight:normal;font-style:normal;border:medium none;color:rgb(153, 153, 153);">;</span> 
  ws<span style="margin:0px;padding:0px;list-style-type:none;text-align:left;text-decoration:none;font-weight:normal;font-style:normal;border:medium none;color:rgb(153, 153, 153);">.</span><span style="margin:0px;padding:0px;list-style-type:none;text-align:left;text-decoration:none;font-weight:normal;font-style:normal;border:medium none;color:rgb(17, 17, 17);">send<span style="margin:0px;padding:0px;list-style-type:none;text-align:left;text-decoration:none;font-weight:normal;font-style:normal;border:medium none;color:rgb(153, 153, 153);">(</span></span><span style="margin:0px;padding:0px;list-style-type:none;text-align:left;text-decoration:none;font-weight:normal;font-style:normal;border:medium none;color:rgb(102, 153, 0);">"Hello WebSockets!"</span><span style="margin:0px;padding:0px;list-style-type:none;text-align:left;text-decoration:none;font-weight:normal;font-style:normal;border:medium none;color:rgb(153, 153, 153);">)</span><span style="margin:0px;padding:0px;list-style-type:none;text-align:left;text-decoration:none;font-weight:normal;font-style:normal;border:medium none;color:rgb(153, 153, 153);">;</span>
<span style="margin:0px;padding:0px;list-style-type:none;text-align:left;text-decoration:none;font-weight:normal;font-style:normal;border:medium none;color:rgb(153, 153, 153);">}</span><span style="margin:0px;padding:0px;list-style-type:none;text-align:left;text-decoration:none;font-weight:normal;font-style:normal;border:medium none;color:rgb(153, 153, 153);">;</span>

ws<span style="margin:0px;padding:0px;list-style-type:none;text-align:left;text-decoration:none;font-weight:normal;font-style:normal;border:medium none;color:rgb(153, 153, 153);">.</span>onmessage <span style="margin:0px;padding:0px;list-style-type:none;text-align:left;text-decoration:none;font-weight:normal;font-style:normal;border:medium none;background:rgba(255, 255, 255, 0.5) none repeat scroll 0% 0%;color:rgb(166, 127, 89);background-color:rgb(204, 232, 207);">=</span> <span style="margin:0px;padding:0px;list-style-type:none;text-align:left;text-decoration:none;font-weight:normal;font-style:normal;border:medium none;color:rgb(0, 119, 170);">function</span><span style="margin:0px;padding:0px;list-style-type:none;text-align:left;text-decoration:none;font-weight:normal;font-style:normal;border:medium none;color:rgb(153, 153, 153);">(</span>evt<span style="margin:0px;padding:0px;list-style-type:none;text-align:left;text-decoration:none;font-weight:normal;font-style:normal;border:medium none;color:rgb(153, 153, 153);">)</span> <span style="margin:0px;padding:0px;list-style-type:none;text-align:left;text-decoration:none;font-weight:normal;font-style:normal;border:medium none;color:rgb(153, 153, 153);">{</span>
  console<span style="margin:0px;padding:0px;list-style-type:none;text-align:left;text-decoration:none;font-weight:normal;font-style:normal;border:medium none;color:rgb(153, 153, 153);">.</span><span style="margin:0px;padding:0px;list-style-type:none;text-align:left;text-decoration:none;font-weight:normal;font-style:normal;border:medium none;color:rgb(17, 17, 17);">log<span style="margin:0px;padding:0px;list-style-type:none;text-align:left;text-decoration:none;font-weight:normal;font-style:normal;border:medium none;color:rgb(153, 153, 153);">(</span></span> <span style="margin:0px;padding:0px;list-style-type:none;text-align:left;text-decoration:none;font-weight:normal;font-style:normal;border:medium none;color:rgb(102, 153, 0);">"Received Message: "</span> <span style="margin:0px;padding:0px;list-style-type:none;text-align:left;text-decoration:none;font-weight:normal;font-style:normal;border:medium none;background:rgba(255, 255, 255, 0.5) none repeat scroll 0% 0%;color:rgb(166, 127, 89);background-color:rgb(204, 232, 207);">+</span> evt<span style="margin:0px;padding:0px;list-style-type:none;text-align:left;text-decoration:none;font-weight:normal;font-style:normal;border:medium none;color:rgb(153, 153, 153);">.</span>data<span style="margin:0px;padding:0px;list-style-type:none;text-align:left;text-decoration:none;font-weight:normal;font-style:normal;border:medium none;color:rgb(153, 153, 153);">)</span><span style="margin:0px;padding:0px;list-style-type:none;text-align:left;text-decoration:none;font-weight:normal;font-style:normal;border:medium none;color:rgb(153, 153, 153);">;</span>
  ws<span style="margin:0px;padding:0px;list-style-type:none;text-align:left;text-decoration:none;font-weight:normal;font-style:normal;border:medium none;color:rgb(153, 153, 153);">.</span><span style="margin:0px;padding:0px;list-style-type:none;text-align:left;text-decoration:none;font-weight:normal;font-style:normal;border:medium none;color:rgb(17, 17, 17);">close<span style="margin:0px;padding:0px;list-style-type:none;text-align:left;text-decoration:none;font-weight:normal;font-style:normal;border:medium none;color:rgb(153, 153, 153);">(</span></span><span style="margin:0px;padding:0px;list-style-type:none;text-align:left;text-decoration:none;font-weight:normal;font-style:normal;border:medium none;color:rgb(153, 153, 153);">)</span><span style="margin:0px;padding:0px;list-style-type:none;text-align:left;text-decoration:none;font-weight:normal;font-style:normal;border:medium none;color:rgb(153, 153, 153);">;</span>
<span style="margin:0px;padding:0px;list-style-type:none;text-align:left;text-decoration:none;font-weight:normal;font-style:normal;border:medium none;color:rgb(153, 153, 153);">}</span><span style="margin:0px;padding:0px;list-style-type:none;text-align:left;text-decoration:none;font-weight:normal;font-style:normal;border:medium none;color:rgb(153, 153, 153);">;</span>

ws<span style="margin:0px;padding:0px;list-style-type:none;text-align:left;text-decoration:none;font-weight:normal;font-style:normal;border:medium none;color:rgb(153, 153, 153);">.</span>onclose <span style="margin:0px;padding:0px;list-style-type:none;text-align:left;text-decoration:none;font-weight:normal;font-style:normal;border:medium none;background:rgba(255, 255, 255, 0.5) none repeat scroll 0% 0%;color:rgb(166, 127, 89);background-color:rgb(204, 232, 207);">=</span> <span style="margin:0px;padding:0px;list-style-type:none;text-align:left;text-decoration:none;font-weight:normal;font-style:normal;border:medium none;color:rgb(0, 119, 170);">function</span><span style="margin:0px;padding:0px;list-style-type:none;text-align:left;text-decoration:none;font-weight:normal;font-style:normal;border:medium none;color:rgb(153, 153, 153);">(</span>evt<span style="margin:0px;padding:0px;list-style-type:none;text-align:left;text-decoration:none;font-weight:normal;font-style:normal;border:medium none;color:rgb(153, 153, 153);">)</span> <span style="margin:0px;padding:0px;list-style-type:none;text-align:left;text-decoration:none;font-weight:normal;font-style:normal;border:medium none;color:rgb(153, 153, 153);">{</span>
  console<span style="margin:0px;padding:0px;list-style-type:none;text-align:left;text-decoration:none;font-weight:normal;font-style:normal;border:medium none;color:rgb(153, 153, 153);">.</span><span style="margin:0px;padding:0px;list-style-type:none;text-align:left;text-decoration:none;font-weight:normal;font-style:normal;border:medium none;color:rgb(17, 17, 17);">log<span style="margin:0px;padding:0px;list-style-type:none;text-align:left;text-decoration:none;font-weight:normal;font-style:normal;border:medium none;color:rgb(153, 153, 153);">(</span></span><span style="margin:0px;padding:0px;list-style-type:none;text-align:left;text-decoration:none;font-weight:normal;font-style:normal;border:medium none;color:rgb(102, 153, 0);">"Connection closed."</span><span style="margin:0px;padding:0px;list-style-type:none;text-align:left;text-decoration:none;font-weight:normal;font-style:normal;border:medium none;color:rgb(153, 153, 153);">)</span><span style="margin:0px;padding:0px;list-style-type:none;text-align:left;text-decoration:none;font-weight:normal;font-style:normal;border:medium none;color:rgb(153, 153, 153);">;</span>
<span style="margin:0px;padding:0px;list-style-type:none;text-align:left;text-decoration:none;font-weight:normal;font-style:normal;border:medium none;color:rgb(153, 153, 153);">}</span><span style="margin:0px;padding:0px;list-style-type:none;text-align:left;text-decoration:none;font-weight:normal;font-style:normal;border:medium none;color:rgb(153, 153, 153);">;</span>      
</code></pre></blockquote>

<h2 style="list-style-type:none;text-align:left;text-decoration:none;font-style:normal;border:medium none;font-size:2.88em;line-height:1.35em;letter-spacing:-0.03em;border-bottom:1px solid rgb(211, 211, 211);margin:0.4em 0px 0.2em;padding:0px 0px 0.2em;font-weight:500;color:rgb(0, 0, 0);margin-top:1.5em;">四、客户端的 API</h2>

<p style="margin:0px;padding:0px;list-style-type:none;text-align:left;text-decoration:none;font-weight:normal;font-style:normal;border:medium none;color:rgb(17, 17, 17);font-size:1.6em;margin-top:1em;margin-left:0.8em;line-height:180%;">WebSocket 客户端的 API 如下。</p>

<h3 style="list-style-type:none;text-align:left;text-decoration:none;font-style:normal;border:medium none;font-size:1.87em;letter-spacing:-0.03em;border-bottom:1px solid rgb(211, 211, 211);margin:0.4em 0px 0.2em;padding:0px 0px 0.2em;font-weight:500;color:rgb(0, 0, 0);margin-top:1.5em;">4.1 WebSocket 构造函数</h3>

<p style="margin:0px;padding:0px;list-style-type:none;text-align:left;text-decoration:none;font-weight:normal;font-style:normal;border:medium none;color:rgb(17, 17, 17);font-size:1.6em;margin-top:1em;margin-left:0.8em;line-height:180%;">WebSocket 对象作为一个构造函数，用于新建 WebSocket 实例。</p>

<blockquote style="list-style-type:none;text-align:left;text-decoration:none;font-weight:normal;font-style:normal;border:medium none;color:rgb(17, 17, 17);background-color:rgb(245, 242, 240);border-radius:1em;font-family:Consolas, Monaco, &quot;Andale Mono&quot;, monospace;border-width:0.3em;border-color:rgb(224, 223, 204);border-style:solid;text-shadow:white 0px 1px;overflow:auto;margin:2em;padding:1em;"><pre style="margin:0px;list-style-type:none;text-decoration:none;font-weight:normal;font-style:normal;border:medium none;text-shadow:white 0px 1px;font-family:monospace, Consolas, Monaco, &quot;Andale Mono&quot;;direction:ltr;white-space:pre;word-spacing:normal;font-size:1.2em;hyphens:none;text-align:left;color:black;overflow:auto;padding:0em 0em 0.5em;background:rgb(245, 242, 240) none repeat scroll 0% 0%;" xml:space="preserve"><code style="margin:0px;padding:0px;list-style-type:none;text-decoration:none;font-weight:normal;font-style:normal;border:medium none;text-shadow:white 0px 1px;font-family:monospace, Consolas, Monaco, &quot;Andale Mono&quot;;direction:ltr;white-space:pre;word-spacing:normal;font-size:1.2em;hyphens:none;text-align:left;color:black;">
<span style="margin:0px;padding:0px;list-style-type:none;text-align:left;text-decoration:none;font-weight:normal;font-style:normal;border:medium none;color:rgb(0, 119, 170);">var</span> ws <span style="margin:0px;padding:0px;list-style-type:none;text-align:left;text-decoration:none;font-weight:normal;font-style:normal;border:medium none;background:rgba(255, 255, 255, 0.5) none repeat scroll 0% 0%;color:rgb(166, 127, 89);background-color:rgb(204, 232, 207);">=</span> <span style="margin:0px;padding:0px;list-style-type:none;text-align:left;text-decoration:none;font-weight:normal;font-style:normal;border:medium none;color:rgb(0, 119, 170);">new</span> <span style="margin:0px;padding:0px;list-style-type:none;text-align:left;text-decoration:none;font-weight:normal;font-style:normal;border:medium none;color:rgb(17, 17, 17);">WebSocket</span><span style="margin:0px;padding:0px;list-style-type:none;text-align:left;text-decoration:none;font-weight:normal;font-style:normal;border:medium none;color:rgb(153, 153, 153);">(</span><span style="margin:0px;padding:0px;list-style-type:none;text-align:left;text-decoration:none;font-weight:normal;font-style:normal;border:medium none;color:rgb(102, 153, 0);">'ws://localhost:8080'</span><span style="margin:0px;padding:0px;list-style-type:none;text-align:left;text-decoration:none;font-weight:normal;font-style:normal;border:medium none;color:rgb(153, 153, 153);">)</span><span style="margin:0px;padding:0px;list-style-type:none;text-align:left;text-decoration:none;font-weight:normal;font-style:normal;border:medium none;color:rgb(153, 153, 153);">;</span>
</code></pre></blockquote>

<p style="margin:0px;padding:0px;list-style-type:none;text-align:left;text-decoration:none;font-weight:normal;font-style:normal;border:medium none;color:rgb(17, 17, 17);font-size:1.6em;margin-top:1em;margin-left:0.8em;line-height:180%;">执行上面语句之后，客户端就会与服务器进行连接。</p>

<p style="margin:0px;padding:0px;list-style-type:none;text-align:left;text-decoration:none;font-weight:normal;font-style:normal;border:medium none;color:rgb(17, 17, 17);font-size:1.6em;margin-top:1em;margin-left:0.8em;line-height:180%;">实例对象的所有属性和方法清单，参见<a href="https://developer.mozilla.org/en-US/docs/Web/API/WebSocket" target="_blank" style="margin:0px;padding:0px;list-style-type:none;text-align:left;font-weight:normal;font-style:normal;border:medium none;text-decoration:underline;color:rgb(34, 52, 114);">这里</a>。</p>

<h3 style="list-style-type:none;text-align:left;text-decoration:none;font-style:normal;border:medium none;font-size:1.87em;letter-spacing:-0.03em;border-bottom:1px solid rgb(211, 211, 211);margin:0.4em 0px 0.2em;padding:0px 0px 0.2em;font-weight:500;color:rgb(0, 0, 0);margin-top:1.5em;">4.2 webSocket.readyState</h3>

<p style="margin:0px;padding:0px;list-style-type:none;text-align:left;text-decoration:none;font-weight:normal;font-style:normal;border:medium none;color:rgb(17, 17, 17);font-size:1.6em;margin-top:1em;margin-left:0.8em;line-height:180%;"><code style="padding:0px;list-style-type:none;text-align:left;text-decoration:none;font-weight:normal;font-style:normal;border:medium none;color:rgb(17, 17, 17);display:inline-block;padding-left:5px;padding-right:5px;font-size:120%;background-color:pink;border-radius:5px;margin:auto 3px;">readyState</code>属性返回实例对象的当前状态，共有四种。</p>

<blockquote style="list-style-type:none;text-align:left;text-decoration:none;font-weight:normal;font-style:normal;border:medium none;color:rgb(17, 17, 17);background-color:rgb(245, 242, 240);border-radius:1em;font-family:Consolas, Monaco, &quot;Andale Mono&quot;, monospace;border-width:0.3em;border-color:rgb(224, 223, 204);border-style:solid;text-shadow:white 0px 1px;overflow:auto;margin:2em;padding:1em;">
  <ul style="margin:0px;padding:0px;list-style-type:none;text-align:left;text-decoration:none;font-weight:normal;font-style:normal;border:medium none;color:rgb(17, 17, 17);margin-left:4em;">
<li style="margin:0px;padding:0px;text-align:left;text-decoration:none;font-weight:normal;font-style:normal;border:medium none;color:rgb(17, 17, 17);font-size:1.6em;line-height:220%;list-style-type:square;">CONNECTING：值为0，表示正在连接。</li>
<li style="margin:0px;padding:0px;text-align:left;text-decoration:none;font-weight:normal;font-style:normal;border:medium none;color:rgb(17, 17, 17);font-size:1.6em;line-height:220%;list-style-type:square;">OPEN：值为1，表示连接成功，可以通信了。</li>
<li style="margin:0px;padding:0px;text-align:left;text-decoration:none;font-weight:normal;font-style:normal;border:medium none;color:rgb(17, 17, 17);font-size:1.6em;line-height:220%;list-style-type:square;">CLOSING：值为2，表示连接正在关闭。</li>
<li style="margin:0px;padding:0px;text-align:left;text-decoration:none;font-weight:normal;font-style:normal;border:medium none;color:rgb(17, 17, 17);font-size:1.6em;line-height:220%;list-style-type:square;">CLOSED：值为3，表示连接已经关闭，或者打开连接失败。</li>
</ul>
</blockquote>

<p style="margin:0px;padding:0px;list-style-type:none;text-align:left;text-decoration:none;font-weight:normal;font-style:normal;border:medium none;color:rgb(17, 17, 17);font-size:1.6em;margin-top:1em;margin-left:0.8em;line-height:180%;">下面是一个示例。</p>

<blockquote style="list-style-type:none;text-align:left;text-decoration:none;font-weight:normal;font-style:normal;border:medium none;color:rgb(17, 17, 17);background-color:rgb(245, 242, 240);border-radius:1em;font-family:Consolas, Monaco, &quot;Andale Mono&quot;, monospace;border-width:0.3em;border-color:rgb(224, 223, 204);border-style:solid;text-shadow:white 0px 1px;overflow:auto;margin:2em;padding:1em;"><pre style="margin:0px;list-style-type:none;text-decoration:none;font-weight:normal;font-style:normal;border:medium none;text-shadow:white 0px 1px;font-family:monospace, Consolas, Monaco, &quot;Andale Mono&quot;;direction:ltr;white-space:pre;word-spacing:normal;font-size:1.2em;hyphens:none;text-align:left;color:black;overflow:auto;padding:0em 0em 0.5em;background:rgb(245, 242, 240) none repeat scroll 0% 0%;" xml:space="preserve"><code style="margin:0px;padding:0px;list-style-type:none;text-decoration:none;font-weight:normal;font-style:normal;border:medium none;text-shadow:white 0px 1px;font-family:monospace, Consolas, Monaco, &quot;Andale Mono&quot;;direction:ltr;white-space:pre;word-spacing:normal;font-size:1.2em;hyphens:none;text-align:left;color:black;">
switch <span style="margin:0px;padding:0px;list-style-type:none;text-align:left;text-decoration:none;font-weight:normal;font-style:normal;border:medium none;color:rgb(153, 153, 153);">(</span>ws<span style="margin:0px;padding:0px;list-style-type:none;text-align:left;text-decoration:none;font-weight:normal;font-style:normal;border:medium none;color:rgb(153, 153, 153);">.</span>readyState<span style="margin:0px;padding:0px;list-style-type:none;text-align:left;text-decoration:none;font-weight:normal;font-style:normal;border:medium none;color:rgb(153, 153, 153);">)</span> <span style="margin:0px;padding:0px;list-style-type:none;text-align:left;text-decoration:none;font-weight:normal;font-style:normal;border:medium none;color:rgb(153, 153, 153);">{</span>
  case WebSocket<span style="margin:0px;padding:0px;list-style-type:none;text-align:left;text-decoration:none;font-weight:normal;font-style:normal;border:medium none;color:rgb(153, 153, 153);">.</span>CONNECTING<span style="margin:0px;padding:0px;list-style-type:none;text-align:left;text-decoration:none;font-weight:normal;font-style:normal;border:medium none;color:rgb(153, 153, 153);">:</span>
   <span style="margin:0px;padding:0px;list-style-type:none;text-align:left;text-decoration:none;font-weight:normal;font-style:normal;border:medium none;color:slategray;"> // do something
</span>    <span style="margin:0px;padding:0px;list-style-type:none;text-align:left;text-decoration:none;font-weight:normal;font-style:normal;border:medium none;color:rgb(0, 119, 170);">break</span><span style="margin:0px;padding:0px;list-style-type:none;text-align:left;text-decoration:none;font-weight:normal;font-style:normal;border:medium none;color:rgb(153, 153, 153);">;</span>
  case WebSocket<span style="margin:0px;padding:0px;list-style-type:none;text-align:left;text-decoration:none;font-weight:normal;font-style:normal;border:medium none;color:rgb(153, 153, 153);">.</span>OPEN<span style="margin:0px;padding:0px;list-style-type:none;text-align:left;text-decoration:none;font-weight:normal;font-style:normal;border:medium none;color:rgb(153, 153, 153);">:</span>
   <span style="margin:0px;padding:0px;list-style-type:none;text-align:left;text-decoration:none;font-weight:normal;font-style:normal;border:medium none;color:slategray;"> // do something
</span>    <span style="margin:0px;padding:0px;list-style-type:none;text-align:left;text-decoration:none;font-weight:normal;font-style:normal;border:medium none;color:rgb(0, 119, 170);">break</span><span style="margin:0px;padding:0px;list-style-type:none;text-align:left;text-decoration:none;font-weight:normal;font-style:normal;border:medium none;color:rgb(153, 153, 153);">;</span>
  case WebSocket<span style="margin:0px;padding:0px;list-style-type:none;text-align:left;text-decoration:none;font-weight:normal;font-style:normal;border:medium none;color:rgb(153, 153, 153);">.</span>CLOSING<span style="margin:0px;padding:0px;list-style-type:none;text-align:left;text-decoration:none;font-weight:normal;font-style:normal;border:medium none;color:rgb(153, 153, 153);">:</span>
   <span style="margin:0px;padding:0px;list-style-type:none;text-align:left;text-decoration:none;font-weight:normal;font-style:normal;border:medium none;color:slategray;"> // do something
</span>    <span style="margin:0px;padding:0px;list-style-type:none;text-align:left;text-decoration:none;font-weight:normal;font-style:normal;border:medium none;color:rgb(0, 119, 170);">break</span><span style="margin:0px;padding:0px;list-style-type:none;text-align:left;text-decoration:none;font-weight:normal;font-style:normal;border:medium none;color:rgb(153, 153, 153);">;</span>
  case WebSocket<span style="margin:0px;padding:0px;list-style-type:none;text-align:left;text-decoration:none;font-weight:normal;font-style:normal;border:medium none;color:rgb(153, 153, 153);">.</span>CLOSED<span style="margin:0px;padding:0px;list-style-type:none;text-align:left;text-decoration:none;font-weight:normal;font-style:normal;border:medium none;color:rgb(153, 153, 153);">:</span>
   <span style="margin:0px;padding:0px;list-style-type:none;text-align:left;text-decoration:none;font-weight:normal;font-style:normal;border:medium none;color:slategray;"> // do something
</span>    <span style="margin:0px;padding:0px;list-style-type:none;text-align:left;text-decoration:none;font-weight:normal;font-style:normal;border:medium none;color:rgb(0, 119, 170);">break</span><span style="margin:0px;padding:0px;list-style-type:none;text-align:left;text-decoration:none;font-weight:normal;font-style:normal;border:medium none;color:rgb(153, 153, 153);">;</span>
  default<span style="margin:0px;padding:0px;list-style-type:none;text-align:left;text-decoration:none;font-weight:normal;font-style:normal;border:medium none;color:rgb(153, 153, 153);">:</span>
   <span style="margin:0px;padding:0px;list-style-type:none;text-align:left;text-decoration:none;font-weight:normal;font-style:normal;border:medium none;color:slategray;"> // this never happens
</span>    <span style="margin:0px;padding:0px;list-style-type:none;text-align:left;text-decoration:none;font-weight:normal;font-style:normal;border:medium none;color:rgb(0, 119, 170);">break</span><span style="margin:0px;padding:0px;list-style-type:none;text-align:left;text-decoration:none;font-weight:normal;font-style:normal;border:medium none;color:rgb(153, 153, 153);">;</span>
<span style="margin:0px;padding:0px;list-style-type:none;text-align:left;text-decoration:none;font-weight:normal;font-style:normal;border:medium none;color:rgb(153, 153, 153);">}</span>
</code></pre></blockquote>

<h3 style="list-style-type:none;text-align:left;text-decoration:none;font-style:normal;border:medium none;font-size:1.87em;letter-spacing:-0.03em;border-bottom:1px solid rgb(211, 211, 211);margin:0.4em 0px 0.2em;padding:0px 0px 0.2em;font-weight:500;color:rgb(0, 0, 0);margin-top:1.5em;">4.3 webSocket.onopen</h3>

<p style="margin:0px;padding:0px;list-style-type:none;text-align:left;text-decoration:none;font-weight:normal;font-style:normal;border:medium none;color:rgb(17, 17, 17);font-size:1.6em;margin-top:1em;margin-left:0.8em;line-height:180%;">实例对象的<code style="padding:0px;list-style-type:none;text-align:left;text-decoration:none;font-weight:normal;font-style:normal;border:medium none;color:rgb(17, 17, 17);display:inline-block;padding-left:5px;padding-right:5px;font-size:120%;background-color:pink;border-radius:5px;margin:auto 3px;">onopen</code>属性，用于指定连接成功后的回调函数。</p>

<blockquote style="list-style-type:none;text-align:left;text-decoration:none;font-weight:normal;font-style:normal;border:medium none;color:rgb(17, 17, 17);background-color:rgb(245, 242, 240);border-radius:1em;font-family:Consolas, Monaco, &quot;Andale Mono&quot;, monospace;border-width:0.3em;border-color:rgb(224, 223, 204);border-style:solid;text-shadow:white 0px 1px;overflow:auto;margin:2em;padding:1em;"><pre style="margin:0px;list-style-type:none;text-decoration:none;font-weight:normal;font-style:normal;border:medium none;text-shadow:white 0px 1px;font-family:monospace, Consolas, Monaco, &quot;Andale Mono&quot;;direction:ltr;white-space:pre;word-spacing:normal;font-size:1.2em;hyphens:none;text-align:left;color:black;overflow:auto;padding:0em 0em 0.5em;background:rgb(245, 242, 240) none repeat scroll 0% 0%;" xml:space="preserve"><code style="margin:0px;padding:0px;list-style-type:none;text-decoration:none;font-weight:normal;font-style:normal;border:medium none;text-shadow:white 0px 1px;font-family:monospace, Consolas, Monaco, &quot;Andale Mono&quot;;direction:ltr;white-space:pre;word-spacing:normal;font-size:1.2em;hyphens:none;text-align:left;color:black;">
ws<span style="margin:0px;padding:0px;list-style-type:none;text-align:left;text-decoration:none;font-weight:normal;font-style:normal;border:medium none;color:rgb(153, 153, 153);">.</span>onopen <span style="margin:0px;padding:0px;list-style-type:none;text-align:left;text-decoration:none;font-weight:normal;font-style:normal;border:medium none;background:rgba(255, 255, 255, 0.5) none repeat scroll 0% 0%;color:rgb(166, 127, 89);background-color:rgb(204, 232, 207);">=</span> <span style="margin:0px;padding:0px;list-style-type:none;text-align:left;text-decoration:none;font-weight:normal;font-style:normal;border:medium none;color:rgb(0, 119, 170);">function</span> <span style="margin:0px;padding:0px;list-style-type:none;text-align:left;text-decoration:none;font-weight:normal;font-style:normal;border:medium none;color:rgb(153, 153, 153);">(</span><span style="margin:0px;padding:0px;list-style-type:none;text-align:left;text-decoration:none;font-weight:normal;font-style:normal;border:medium none;color:rgb(153, 153, 153);">)</span> <span style="margin:0px;padding:0px;list-style-type:none;text-align:left;text-decoration:none;font-weight:normal;font-style:normal;border:medium none;color:rgb(153, 153, 153);">{</span>
  ws<span style="margin:0px;padding:0px;list-style-type:none;text-align:left;text-decoration:none;font-weight:normal;font-style:normal;border:medium none;color:rgb(153, 153, 153);">.</span><span style="margin:0px;padding:0px;list-style-type:none;text-align:left;text-decoration:none;font-weight:normal;font-style:normal;border:medium none;color:rgb(17, 17, 17);">send<span style="margin:0px;padding:0px;list-style-type:none;text-align:left;text-decoration:none;font-weight:normal;font-style:normal;border:medium none;color:rgb(153, 153, 153);">(</span></span><span style="margin:0px;padding:0px;list-style-type:none;text-align:left;text-decoration:none;font-weight:normal;font-style:normal;border:medium none;color:rgb(102, 153, 0);">'Hello Server!'</span><span style="margin:0px;padding:0px;list-style-type:none;text-align:left;text-decoration:none;font-weight:normal;font-style:normal;border:medium none;color:rgb(153, 153, 153);">)</span><span style="margin:0px;padding:0px;list-style-type:none;text-align:left;text-decoration:none;font-weight:normal;font-style:normal;border:medium none;color:rgb(153, 153, 153);">;</span>
<span style="margin:0px;padding:0px;list-style-type:none;text-align:left;text-decoration:none;font-weight:normal;font-style:normal;border:medium none;color:rgb(153, 153, 153);">}</span>
</code></pre></blockquote>

<p style="margin:0px;padding:0px;list-style-type:none;text-align:left;text-decoration:none;font-weight:normal;font-style:normal;border:medium none;color:rgb(17, 17, 17);font-size:1.6em;margin-top:1em;margin-left:0.8em;line-height:180%;">如果要指定多个回调函数，可以使用<code style="padding:0px;list-style-type:none;text-align:left;text-decoration:none;font-weight:normal;font-style:normal;border:medium none;color:rgb(17, 17, 17);display:inline-block;padding-left:5px;padding-right:5px;font-size:120%;background-color:pink;border-radius:5px;margin:auto 3px;">addEventListener</code>方法。</p>

<blockquote style="list-style-type:none;text-align:left;text-decoration:none;font-weight:normal;font-style:normal;border:medium none;color:rgb(17, 17, 17);background-color:rgb(245, 242, 240);border-radius:1em;font-family:Consolas, Monaco, &quot;Andale Mono&quot;, monospace;border-width:0.3em;border-color:rgb(224, 223, 204);border-style:solid;text-shadow:white 0px 1px;overflow:auto;margin:2em;padding:1em;"><pre style="margin:0px;list-style-type:none;text-decoration:none;font-weight:normal;font-style:normal;border:medium none;text-shadow:white 0px 1px;font-family:monospace, Consolas, Monaco, &quot;Andale Mono&quot;;direction:ltr;white-space:pre;word-spacing:normal;font-size:1.2em;hyphens:none;text-align:left;color:black;overflow:auto;padding:0em 0em 0.5em;background:rgb(245, 242, 240) none repeat scroll 0% 0%;" xml:space="preserve"><code style="margin:0px;padding:0px;list-style-type:none;text-decoration:none;font-weight:normal;font-style:normal;border:medium none;text-shadow:white 0px 1px;font-family:monospace, Consolas, Monaco, &quot;Andale Mono&quot;;direction:ltr;white-space:pre;word-spacing:normal;font-size:1.2em;hyphens:none;text-align:left;color:black;">
ws<span style="margin:0px;padding:0px;list-style-type:none;text-align:left;text-decoration:none;font-weight:normal;font-style:normal;border:medium none;color:rgb(153, 153, 153);">.</span><span style="margin:0px;padding:0px;list-style-type:none;text-align:left;text-decoration:none;font-weight:normal;font-style:normal;border:medium none;color:rgb(17, 17, 17);">addEventListener<span style="margin:0px;padding:0px;list-style-type:none;text-align:left;text-decoration:none;font-weight:normal;font-style:normal;border:medium none;color:rgb(153, 153, 153);">(</span></span><span style="margin:0px;padding:0px;list-style-type:none;text-align:left;text-decoration:none;font-weight:normal;font-style:normal;border:medium none;color:rgb(102, 153, 0);">'open'</span><span style="margin:0px;padding:0px;list-style-type:none;text-align:left;text-decoration:none;font-weight:normal;font-style:normal;border:medium none;color:rgb(153, 153, 153);">,</span> <span style="margin:0px;padding:0px;list-style-type:none;text-align:left;text-decoration:none;font-weight:normal;font-style:normal;border:medium none;color:rgb(0, 119, 170);">function</span> <span style="margin:0px;padding:0px;list-style-type:none;text-align:left;text-decoration:none;font-weight:normal;font-style:normal;border:medium none;color:rgb(153, 153, 153);">(</span>event<span style="margin:0px;padding:0px;list-style-type:none;text-align:left;text-decoration:none;font-weight:normal;font-style:normal;border:medium none;color:rgb(153, 153, 153);">)</span> <span style="margin:0px;padding:0px;list-style-type:none;text-align:left;text-decoration:none;font-weight:normal;font-style:normal;border:medium none;color:rgb(153, 153, 153);">{</span>
  ws<span style="margin:0px;padding:0px;list-style-type:none;text-align:left;text-decoration:none;font-weight:normal;font-style:normal;border:medium none;color:rgb(153, 153, 153);">.</span><span style="margin:0px;padding:0px;list-style-type:none;text-align:left;text-decoration:none;font-weight:normal;font-style:normal;border:medium none;color:rgb(17, 17, 17);">send<span style="margin:0px;padding:0px;list-style-type:none;text-align:left;text-decoration:none;font-weight:normal;font-style:normal;border:medium none;color:rgb(153, 153, 153);">(</span></span><span style="margin:0px;padding:0px;list-style-type:none;text-align:left;text-decoration:none;font-weight:normal;font-style:normal;border:medium none;color:rgb(102, 153, 0);">'Hello Server!'</span><span style="margin:0px;padding:0px;list-style-type:none;text-align:left;text-decoration:none;font-weight:normal;font-style:normal;border:medium none;color:rgb(153, 153, 153);">)</span><span style="margin:0px;padding:0px;list-style-type:none;text-align:left;text-decoration:none;font-weight:normal;font-style:normal;border:medium none;color:rgb(153, 153, 153);">;</span>
<span style="margin:0px;padding:0px;list-style-type:none;text-align:left;text-decoration:none;font-weight:normal;font-style:normal;border:medium none;color:rgb(153, 153, 153);">}</span><span style="margin:0px;padding:0px;list-style-type:none;text-align:left;text-decoration:none;font-weight:normal;font-style:normal;border:medium none;color:rgb(153, 153, 153);">)</span><span style="margin:0px;padding:0px;list-style-type:none;text-align:left;text-decoration:none;font-weight:normal;font-style:normal;border:medium none;color:rgb(153, 153, 153);">;</span>
</code></pre></blockquote>

<h3 style="list-style-type:none;text-align:left;text-decoration:none;font-style:normal;border:medium none;font-size:1.87em;letter-spacing:-0.03em;border-bottom:1px solid rgb(211, 211, 211);margin:0.4em 0px 0.2em;padding:0px 0px 0.2em;font-weight:500;color:rgb(0, 0, 0);margin-top:1.5em;">4.4 webSocket.onclose</h3>

<p style="margin:0px;padding:0px;list-style-type:none;text-align:left;text-decoration:none;font-weight:normal;font-style:normal;border:medium none;color:rgb(17, 17, 17);font-size:1.6em;margin-top:1em;margin-left:0.8em;line-height:180%;">实例对象的<code style="padding:0px;list-style-type:none;text-align:left;text-decoration:none;font-weight:normal;font-style:normal;border:medium none;color:rgb(17, 17, 17);display:inline-block;padding-left:5px;padding-right:5px;font-size:120%;background-color:pink;border-radius:5px;margin:auto 3px;">onclose</code>属性，用于指定连接关闭后的回调函数。</p>

<blockquote style="list-style-type:none;text-align:left;text-decoration:none;font-weight:normal;font-style:normal;border:medium none;color:rgb(17, 17, 17);background-color:rgb(245, 242, 240);border-radius:1em;font-family:Consolas, Monaco, &quot;Andale Mono&quot;, monospace;border-width:0.3em;border-color:rgb(224, 223, 204);border-style:solid;text-shadow:white 0px 1px;overflow:auto;margin:2em;padding:1em;"><pre style="margin:0px;list-style-type:none;text-decoration:none;font-weight:normal;font-style:normal;border:medium none;text-shadow:white 0px 1px;font-family:monospace, Consolas, Monaco, &quot;Andale Mono&quot;;direction:ltr;white-space:pre;word-spacing:normal;font-size:1.2em;hyphens:none;text-align:left;color:black;overflow:auto;padding:0em 0em 0.5em;background:rgb(245, 242, 240) none repeat scroll 0% 0%;" xml:space="preserve"><code style="margin:0px;padding:0px;list-style-type:none;text-decoration:none;font-weight:normal;font-style:normal;border:medium none;text-shadow:white 0px 1px;font-family:monospace, Consolas, Monaco, &quot;Andale Mono&quot;;direction:ltr;white-space:pre;word-spacing:normal;font-size:1.2em;hyphens:none;text-align:left;color:black;">
ws<span style="margin:0px;padding:0px;list-style-type:none;text-align:left;text-decoration:none;font-weight:normal;font-style:normal;border:medium none;color:rgb(153, 153, 153);">.</span>onclose <span style="margin:0px;padding:0px;list-style-type:none;text-align:left;text-decoration:none;font-weight:normal;font-style:normal;border:medium none;background:rgba(255, 255, 255, 0.5) none repeat scroll 0% 0%;color:rgb(166, 127, 89);background-color:rgb(204, 232, 207);">=</span> <span style="margin:0px;padding:0px;list-style-type:none;text-align:left;text-decoration:none;font-weight:normal;font-style:normal;border:medium none;color:rgb(0, 119, 170);">function</span><span style="margin:0px;padding:0px;list-style-type:none;text-align:left;text-decoration:none;font-weight:normal;font-style:normal;border:medium none;color:rgb(153, 153, 153);">(</span>event<span style="margin:0px;padding:0px;list-style-type:none;text-align:left;text-decoration:none;font-weight:normal;font-style:normal;border:medium none;color:rgb(153, 153, 153);">)</span> <span style="margin:0px;padding:0px;list-style-type:none;text-align:left;text-decoration:none;font-weight:normal;font-style:normal;border:medium none;color:rgb(153, 153, 153);">{</span>
  <span style="margin:0px;padding:0px;list-style-type:none;text-align:left;text-decoration:none;font-weight:normal;font-style:normal;border:medium none;color:rgb(0, 119, 170);">var</span> code <span style="margin:0px;padding:0px;list-style-type:none;text-align:left;text-decoration:none;font-weight:normal;font-style:normal;border:medium none;background:rgba(255, 255, 255, 0.5) none repeat scroll 0% 0%;color:rgb(166, 127, 89);background-color:rgb(204, 232, 207);">=</span> event<span style="margin:0px;padding:0px;list-style-type:none;text-align:left;text-decoration:none;font-weight:normal;font-style:normal;border:medium none;color:rgb(153, 153, 153);">.</span>code<span style="margin:0px;padding:0px;list-style-type:none;text-align:left;text-decoration:none;font-weight:normal;font-style:normal;border:medium none;color:rgb(153, 153, 153);">;</span>
  <span style="margin:0px;padding:0px;list-style-type:none;text-align:left;text-decoration:none;font-weight:normal;font-style:normal;border:medium none;color:rgb(0, 119, 170);">var</span> reason <span style="margin:0px;padding:0px;list-style-type:none;text-align:left;text-decoration:none;font-weight:normal;font-style:normal;border:medium none;background:rgba(255, 255, 255, 0.5) none repeat scroll 0% 0%;color:rgb(166, 127, 89);background-color:rgb(204, 232, 207);">=</span> event<span style="margin:0px;padding:0px;list-style-type:none;text-align:left;text-decoration:none;font-weight:normal;font-style:normal;border:medium none;color:rgb(153, 153, 153);">.</span>reason<span style="margin:0px;padding:0px;list-style-type:none;text-align:left;text-decoration:none;font-weight:normal;font-style:normal;border:medium none;color:rgb(153, 153, 153);">;</span>
  <span style="margin:0px;padding:0px;list-style-type:none;text-align:left;text-decoration:none;font-weight:normal;font-style:normal;border:medium none;color:rgb(0, 119, 170);">var</span> wasClean <span style="margin:0px;padding:0px;list-style-type:none;text-align:left;text-decoration:none;font-weight:normal;font-style:normal;border:medium none;background:rgba(255, 255, 255, 0.5) none repeat scroll 0% 0%;color:rgb(166, 127, 89);background-color:rgb(204, 232, 207);">=</span> event<span style="margin:0px;padding:0px;list-style-type:none;text-align:left;text-decoration:none;font-weight:normal;font-style:normal;border:medium none;color:rgb(153, 153, 153);">.</span>wasClean<span style="margin:0px;padding:0px;list-style-type:none;text-align:left;text-decoration:none;font-weight:normal;font-style:normal;border:medium none;color:rgb(153, 153, 153);">;</span>
 <span style="margin:0px;padding:0px;list-style-type:none;text-align:left;text-decoration:none;font-weight:normal;font-style:normal;border:medium none;color:slategray;"> // handle close event
</span><span style="margin:0px;padding:0px;list-style-type:none;text-align:left;text-decoration:none;font-weight:normal;font-style:normal;border:medium none;color:rgb(153, 153, 153);">}</span><span style="margin:0px;padding:0px;list-style-type:none;text-align:left;text-decoration:none;font-weight:normal;font-style:normal;border:medium none;color:rgb(153, 153, 153);">;</span>

ws<span style="margin:0px;padding:0px;list-style-type:none;text-align:left;text-decoration:none;font-weight:normal;font-style:normal;border:medium none;color:rgb(153, 153, 153);">.</span><span style="margin:0px;padding:0px;list-style-type:none;text-align:left;text-decoration:none;font-weight:normal;font-style:normal;border:medium none;color:rgb(17, 17, 17);">addEventListener<span style="margin:0px;padding:0px;list-style-type:none;text-align:left;text-decoration:none;font-weight:normal;font-style:normal;border:medium none;color:rgb(153, 153, 153);">(</span></span><span style="margin:0px;padding:0px;list-style-type:none;text-align:left;text-decoration:none;font-weight:normal;font-style:normal;border:medium none;color:rgb(102, 153, 0);">"close"</span><span style="margin:0px;padding:0px;list-style-type:none;text-align:left;text-decoration:none;font-weight:normal;font-style:normal;border:medium none;color:rgb(153, 153, 153);">,</span> <span style="margin:0px;padding:0px;list-style-type:none;text-align:left;text-decoration:none;font-weight:normal;font-style:normal;border:medium none;color:rgb(0, 119, 170);">function</span><span style="margin:0px;padding:0px;list-style-type:none;text-align:left;text-decoration:none;font-weight:normal;font-style:normal;border:medium none;color:rgb(153, 153, 153);">(</span>event<span style="margin:0px;padding:0px;list-style-type:none;text-align:left;text-decoration:none;font-weight:normal;font-style:normal;border:medium none;color:rgb(153, 153, 153);">)</span> <span style="margin:0px;padding:0px;list-style-type:none;text-align:left;text-decoration:none;font-weight:normal;font-style:normal;border:medium none;color:rgb(153, 153, 153);">{</span>
  <span style="margin:0px;padding:0px;list-style-type:none;text-align:left;text-decoration:none;font-weight:normal;font-style:normal;border:medium none;color:rgb(0, 119, 170);">var</span> code <span style="margin:0px;padding:0px;list-style-type:none;text-align:left;text-decoration:none;font-weight:normal;font-style:normal;border:medium none;background:rgba(255, 255, 255, 0.5) none repeat scroll 0% 0%;color:rgb(166, 127, 89);background-color:rgb(204, 232, 207);">=</span> event<span style="margin:0px;padding:0px;list-style-type:none;text-align:left;text-decoration:none;font-weight:normal;font-style:normal;border:medium none;color:rgb(153, 153, 153);">.</span>code<span style="margin:0px;padding:0px;list-style-type:none;text-align:left;text-decoration:none;font-weight:normal;font-style:normal;border:medium none;color:rgb(153, 153, 153);">;</span>
  <span style="margin:0px;padding:0px;list-style-type:none;text-align:left;text-decoration:none;font-weight:normal;font-style:normal;border:medium none;color:rgb(0, 119, 170);">var</span> reason <span style="margin:0px;padding:0px;list-style-type:none;text-align:left;text-decoration:none;font-weight:normal;font-style:normal;border:medium none;background:rgba(255, 255, 255, 0.5) none repeat scroll 0% 0%;color:rgb(166, 127, 89);background-color:rgb(204, 232, 207);">=</span> event<span style="margin:0px;padding:0px;list-style-type:none;text-align:left;text-decoration:none;font-weight:normal;font-style:normal;border:medium none;color:rgb(153, 153, 153);">.</span>reason<span style="margin:0px;padding:0px;list-style-type:none;text-align:left;text-decoration:none;font-weight:normal;font-style:normal;border:medium none;color:rgb(153, 153, 153);">;</span>
  <span style="margin:0px;padding:0px;list-style-type:none;text-align:left;text-decoration:none;font-weight:normal;font-style:normal;border:medium none;color:rgb(0, 119, 170);">var</span> wasClean <span style="margin:0px;padding:0px;list-style-type:none;text-align:left;text-decoration:none;font-weight:normal;font-style:normal;border:medium none;background:rgba(255, 255, 255, 0.5) none repeat scroll 0% 0%;color:rgb(166, 127, 89);background-color:rgb(204, 232, 207);">=</span> event<span style="margin:0px;padding:0px;list-style-type:none;text-align:left;text-decoration:none;font-weight:normal;font-style:normal;border:medium none;color:rgb(153, 153, 153);">.</span>wasClean<span style="margin:0px;padding:0px;list-style-type:none;text-align:left;text-decoration:none;font-weight:normal;font-style:normal;border:medium none;color:rgb(153, 153, 153);">;</span>
 <span style="margin:0px;padding:0px;list-style-type:none;text-align:left;text-decoration:none;font-weight:normal;font-style:normal;border:medium none;color:slategray;"> // handle close event
</span><span style="margin:0px;padding:0px;list-style-type:none;text-align:left;text-decoration:none;font-weight:normal;font-style:normal;border:medium none;color:rgb(153, 153, 153);">}</span><span style="margin:0px;padding:0px;list-style-type:none;text-align:left;text-decoration:none;font-weight:normal;font-style:normal;border:medium none;color:rgb(153, 153, 153);">)</span><span style="margin:0px;padding:0px;list-style-type:none;text-align:left;text-decoration:none;font-weight:normal;font-style:normal;border:medium none;color:rgb(153, 153, 153);">;</span>
</code></pre></blockquote>

<h3 style="list-style-type:none;text-align:left;text-decoration:none;font-style:normal;border:medium none;font-size:1.87em;letter-spacing:-0.03em;border-bottom:1px solid rgb(211, 211, 211);margin:0.4em 0px 0.2em;padding:0px 0px 0.2em;font-weight:500;color:rgb(0, 0, 0);margin-top:1.5em;">4.5 webSocket.onmessage</h3>

<p style="margin:0px;padding:0px;list-style-type:none;text-align:left;text-decoration:none;font-weight:normal;font-style:normal;border:medium none;color:rgb(17, 17, 17);font-size:1.6em;margin-top:1em;margin-left:0.8em;line-height:180%;">实例对象的<code style="padding:0px;list-style-type:none;text-align:left;text-decoration:none;font-weight:normal;font-style:normal;border:medium none;color:rgb(17, 17, 17);display:inline-block;padding-left:5px;padding-right:5px;font-size:120%;background-color:pink;border-radius:5px;margin:auto 3px;">onmessage</code>属性，用于指定收到服务器数据后的回调函数。</p>

<blockquote style="list-style-type:none;text-align:left;text-decoration:none;font-weight:normal;font-style:normal;border:medium none;color:rgb(17, 17, 17);background-color:rgb(245, 242, 240);border-radius:1em;font-family:Consolas, Monaco, &quot;Andale Mono&quot;, monospace;border-width:0.3em;border-color:rgb(224, 223, 204);border-style:solid;text-shadow:white 0px 1px;overflow:auto;margin:2em;padding:1em;"><pre style="margin:0px;list-style-type:none;text-decoration:none;font-weight:normal;font-style:normal;border:medium none;text-shadow:white 0px 1px;font-family:monospace, Consolas, Monaco, &quot;Andale Mono&quot;;direction:ltr;white-space:pre;word-spacing:normal;font-size:1.2em;hyphens:none;text-align:left;color:black;overflow:auto;padding:0em 0em 0.5em;background:rgb(245, 242, 240) none repeat scroll 0% 0%;" xml:space="preserve"><code style="margin:0px;padding:0px;list-style-type:none;text-decoration:none;font-weight:normal;font-style:normal;border:medium none;text-shadow:white 0px 1px;font-family:monospace, Consolas, Monaco, &quot;Andale Mono&quot;;direction:ltr;white-space:pre;word-spacing:normal;font-size:1.2em;hyphens:none;text-align:left;color:black;">
ws<span style="margin:0px;padding:0px;list-style-type:none;text-align:left;text-decoration:none;font-weight:normal;font-style:normal;border:medium none;color:rgb(153, 153, 153);">.</span>onmessage <span style="margin:0px;padding:0px;list-style-type:none;text-align:left;text-decoration:none;font-weight:normal;font-style:normal;border:medium none;background:rgba(255, 255, 255, 0.5) none repeat scroll 0% 0%;color:rgb(166, 127, 89);background-color:rgb(204, 232, 207);">=</span> <span style="margin:0px;padding:0px;list-style-type:none;text-align:left;text-decoration:none;font-weight:normal;font-style:normal;border:medium none;color:rgb(0, 119, 170);">function</span><span style="margin:0px;padding:0px;list-style-type:none;text-align:left;text-decoration:none;font-weight:normal;font-style:normal;border:medium none;color:rgb(153, 153, 153);">(</span>event<span style="margin:0px;padding:0px;list-style-type:none;text-align:left;text-decoration:none;font-weight:normal;font-style:normal;border:medium none;color:rgb(153, 153, 153);">)</span> <span style="margin:0px;padding:0px;list-style-type:none;text-align:left;text-decoration:none;font-weight:normal;font-style:normal;border:medium none;color:rgb(153, 153, 153);">{</span>
  <span style="margin:0px;padding:0px;list-style-type:none;text-align:left;text-decoration:none;font-weight:normal;font-style:normal;border:medium none;color:rgb(0, 119, 170);">var</span> data <span style="margin:0px;padding:0px;list-style-type:none;text-align:left;text-decoration:none;font-weight:normal;font-style:normal;border:medium none;background:rgba(255, 255, 255, 0.5) none repeat scroll 0% 0%;color:rgb(166, 127, 89);background-color:rgb(204, 232, 207);">=</span> event<span style="margin:0px;padding:0px;list-style-type:none;text-align:left;text-decoration:none;font-weight:normal;font-style:normal;border:medium none;color:rgb(153, 153, 153);">.</span>data<span style="margin:0px;padding:0px;list-style-type:none;text-align:left;text-decoration:none;font-weight:normal;font-style:normal;border:medium none;color:rgb(153, 153, 153);">;</span>
 <span style="margin:0px;padding:0px;list-style-type:none;text-align:left;text-decoration:none;font-weight:normal;font-style:normal;border:medium none;color:slategray;"> // 处理数据
</span><span style="margin:0px;padding:0px;list-style-type:none;text-align:left;text-decoration:none;font-weight:normal;font-style:normal;border:medium none;color:rgb(153, 153, 153);">}</span><span style="margin:0px;padding:0px;list-style-type:none;text-align:left;text-decoration:none;font-weight:normal;font-style:normal;border:medium none;color:rgb(153, 153, 153);">;</span>

ws<span style="margin:0px;padding:0px;list-style-type:none;text-align:left;text-decoration:none;font-weight:normal;font-style:normal;border:medium none;color:rgb(153, 153, 153);">.</span><span style="margin:0px;padding:0px;list-style-type:none;text-align:left;text-decoration:none;font-weight:normal;font-style:normal;border:medium none;color:rgb(17, 17, 17);">addEventListener<span style="margin:0px;padding:0px;list-style-type:none;text-align:left;text-decoration:none;font-weight:normal;font-style:normal;border:medium none;color:rgb(153, 153, 153);">(</span></span><span style="margin:0px;padding:0px;list-style-type:none;text-align:left;text-decoration:none;font-weight:normal;font-style:normal;border:medium none;color:rgb(102, 153, 0);">"message"</span><span style="margin:0px;padding:0px;list-style-type:none;text-align:left;text-decoration:none;font-weight:normal;font-style:normal;border:medium none;color:rgb(153, 153, 153);">,</span> <span style="margin:0px;padding:0px;list-style-type:none;text-align:left;text-decoration:none;font-weight:normal;font-style:normal;border:medium none;color:rgb(0, 119, 170);">function</span><span style="margin:0px;padding:0px;list-style-type:none;text-align:left;text-decoration:none;font-weight:normal;font-style:normal;border:medium none;color:rgb(153, 153, 153);">(</span>event<span style="margin:0px;padding:0px;list-style-type:none;text-align:left;text-decoration:none;font-weight:normal;font-style:normal;border:medium none;color:rgb(153, 153, 153);">)</span> <span style="margin:0px;padding:0px;list-style-type:none;text-align:left;text-decoration:none;font-weight:normal;font-style:normal;border:medium none;color:rgb(153, 153, 153);">{</span>
  <span style="margin:0px;padding:0px;list-style-type:none;text-align:left;text-decoration:none;font-weight:normal;font-style:normal;border:medium none;color:rgb(0, 119, 170);">var</span> data <span style="margin:0px;padding:0px;list-style-type:none;text-align:left;text-decoration:none;font-weight:normal;font-style:normal;border:medium none;background:rgba(255, 255, 255, 0.5) none repeat scroll 0% 0%;color:rgb(166, 127, 89);background-color:rgb(204, 232, 207);">=</span> event<span style="margin:0px;padding:0px;list-style-type:none;text-align:left;text-decoration:none;font-weight:normal;font-style:normal;border:medium none;color:rgb(153, 153, 153);">.</span>data<span style="margin:0px;padding:0px;list-style-type:none;text-align:left;text-decoration:none;font-weight:normal;font-style:normal;border:medium none;color:rgb(153, 153, 153);">;</span>
 <span style="margin:0px;padding:0px;list-style-type:none;text-align:left;text-decoration:none;font-weight:normal;font-style:normal;border:medium none;color:slategray;"> // 处理数据
</span><span style="margin:0px;padding:0px;list-style-type:none;text-align:left;text-decoration:none;font-weight:normal;font-style:normal;border:medium none;color:rgb(153, 153, 153);">}</span><span style="margin:0px;padding:0px;list-style-type:none;text-align:left;text-decoration:none;font-weight:normal;font-style:normal;border:medium none;color:rgb(153, 153, 153);">)</span><span style="margin:0px;padding:0px;list-style-type:none;text-align:left;text-decoration:none;font-weight:normal;font-style:normal;border:medium none;color:rgb(153, 153, 153);">;</span>
</code></pre></blockquote>

<p style="margin:0px;padding:0px;list-style-type:none;text-align:left;text-decoration:none;font-weight:normal;font-style:normal;border:medium none;color:rgb(17, 17, 17);font-size:1.6em;margin-top:1em;margin-left:0.8em;line-height:180%;">注意，服务器数据可能是文本，也可能是二进制数据（<code style="padding:0px;list-style-type:none;text-align:left;text-decoration:none;font-weight:normal;font-style:normal;border:medium none;color:rgb(17, 17, 17);display:inline-block;padding-left:5px;padding-right:5px;font-size:120%;background-color:pink;border-radius:5px;margin:auto 3px;">blob</code>对象或<code style="padding:0px;list-style-type:none;text-align:left;text-decoration:none;font-weight:normal;font-style:normal;border:medium none;color:rgb(17, 17, 17);display:inline-block;padding-left:5px;padding-right:5px;font-size:120%;background-color:pink;border-radius:5px;margin:auto 3px;">Arraybuffer</code>对象）。</p>

<blockquote style="list-style-type:none;text-align:left;text-decoration:none;font-weight:normal;font-style:normal;border:medium none;color:rgb(17, 17, 17);background-color:rgb(245, 242, 240);border-radius:1em;font-family:Consolas, Monaco, &quot;Andale Mono&quot;, monospace;border-width:0.3em;border-color:rgb(224, 223, 204);border-style:solid;text-shadow:white 0px 1px;overflow:auto;margin:2em;padding:1em;"><pre style="margin:0px;list-style-type:none;text-decoration:none;font-weight:normal;font-style:normal;border:medium none;text-shadow:white 0px 1px;font-family:monospace, Consolas, Monaco, &quot;Andale Mono&quot;;direction:ltr;white-space:pre;word-spacing:normal;font-size:1.2em;hyphens:none;text-align:left;color:black;overflow:auto;padding:0em 0em 0.5em;background:rgb(245, 242, 240) none repeat scroll 0% 0%;" xml:space="preserve"><code style="margin:0px;padding:0px;list-style-type:none;text-decoration:none;font-weight:normal;font-style:normal;border:medium none;text-shadow:white 0px 1px;font-family:monospace, Consolas, Monaco, &quot;Andale Mono&quot;;direction:ltr;white-space:pre;word-spacing:normal;font-size:1.2em;hyphens:none;text-align:left;color:black;">
ws<span style="margin:0px;padding:0px;list-style-type:none;text-align:left;text-decoration:none;font-weight:normal;font-style:normal;border:medium none;color:rgb(153, 153, 153);">.</span>onmessage <span style="margin:0px;padding:0px;list-style-type:none;text-align:left;text-decoration:none;font-weight:normal;font-style:normal;border:medium none;background:rgba(255, 255, 255, 0.5) none repeat scroll 0% 0%;color:rgb(166, 127, 89);background-color:rgb(204, 232, 207);">=</span> <span style="margin:0px;padding:0px;list-style-type:none;text-align:left;text-decoration:none;font-weight:normal;font-style:normal;border:medium none;color:rgb(0, 119, 170);">function</span><span style="margin:0px;padding:0px;list-style-type:none;text-align:left;text-decoration:none;font-weight:normal;font-style:normal;border:medium none;color:rgb(153, 153, 153);">(</span>event<span style="margin:0px;padding:0px;list-style-type:none;text-align:left;text-decoration:none;font-weight:normal;font-style:normal;border:medium none;color:rgb(153, 153, 153);">)</span><span style="margin:0px;padding:0px;list-style-type:none;text-align:left;text-decoration:none;font-weight:normal;font-style:normal;border:medium none;color:rgb(153, 153, 153);">{</span>
  <span style="margin:0px;padding:0px;list-style-type:none;text-align:left;text-decoration:none;font-weight:normal;font-style:normal;border:medium none;color:rgb(0, 119, 170);">if</span><span style="margin:0px;padding:0px;list-style-type:none;text-align:left;text-decoration:none;font-weight:normal;font-style:normal;border:medium none;color:rgb(153, 153, 153);">(</span><span style="margin:0px;padding:0px;list-style-type:none;text-align:left;text-decoration:none;font-weight:normal;font-style:normal;border:medium none;color:rgb(0, 119, 170);">typeof</span> event<span style="margin:0px;padding:0px;list-style-type:none;text-align:left;text-decoration:none;font-weight:normal;font-style:normal;border:medium none;color:rgb(153, 153, 153);">.</span>data <span style="margin:0px;padding:0px;list-style-type:none;text-align:left;text-decoration:none;font-weight:normal;font-style:normal;border:medium none;background:rgba(255, 255, 255, 0.5) none repeat scroll 0% 0%;color:rgb(166, 127, 89);background-color:rgb(204, 232, 207);">===</span> String<span style="margin:0px;padding:0px;list-style-type:none;text-align:left;text-decoration:none;font-weight:normal;font-style:normal;border:medium none;color:rgb(153, 153, 153);">)</span> <span style="margin:0px;padding:0px;list-style-type:none;text-align:left;text-decoration:none;font-weight:normal;font-style:normal;border:medium none;color:rgb(153, 153, 153);">{</span>
    console<span style="margin:0px;padding:0px;list-style-type:none;text-align:left;text-decoration:none;font-weight:normal;font-style:normal;border:medium none;color:rgb(153, 153, 153);">.</span><span style="margin:0px;padding:0px;list-style-type:none;text-align:left;text-decoration:none;font-weight:normal;font-style:normal;border:medium none;color:rgb(17, 17, 17);">log<span style="margin:0px;padding:0px;list-style-type:none;text-align:left;text-decoration:none;font-weight:normal;font-style:normal;border:medium none;color:rgb(153, 153, 153);">(</span></span><span style="margin:0px;padding:0px;list-style-type:none;text-align:left;text-decoration:none;font-weight:normal;font-style:normal;border:medium none;color:rgb(102, 153, 0);">"Received data string"</span><span style="margin:0px;padding:0px;list-style-type:none;text-align:left;text-decoration:none;font-weight:normal;font-style:normal;border:medium none;color:rgb(153, 153, 153);">)</span><span style="margin:0px;padding:0px;list-style-type:none;text-align:left;text-decoration:none;font-weight:normal;font-style:normal;border:medium none;color:rgb(153, 153, 153);">;</span>
  <span style="margin:0px;padding:0px;list-style-type:none;text-align:left;text-decoration:none;font-weight:normal;font-style:normal;border:medium none;color:rgb(153, 153, 153);">}</span>

  <span style="margin:0px;padding:0px;list-style-type:none;text-align:left;text-decoration:none;font-weight:normal;font-style:normal;border:medium none;color:rgb(0, 119, 170);">if</span><span style="margin:0px;padding:0px;list-style-type:none;text-align:left;text-decoration:none;font-weight:normal;font-style:normal;border:medium none;color:rgb(153, 153, 153);">(</span>event<span style="margin:0px;padding:0px;list-style-type:none;text-align:left;text-decoration:none;font-weight:normal;font-style:normal;border:medium none;color:rgb(153, 153, 153);">.</span>data <span style="margin:0px;padding:0px;list-style-type:none;text-align:left;text-decoration:none;font-weight:normal;font-style:normal;border:medium none;color:rgb(0, 119, 170);">instanceof</span> <span style="margin:0px;padding:0px;list-style-type:none;text-align:left;text-decoration:none;font-weight:normal;font-style:normal;border:medium none;color:rgb(17, 17, 17);">ArrayBuffer</span><span style="margin:0px;padding:0px;list-style-type:none;text-align:left;text-decoration:none;font-weight:normal;font-style:normal;border:medium none;color:rgb(153, 153, 153);">)</span><span style="margin:0px;padding:0px;list-style-type:none;text-align:left;text-decoration:none;font-weight:normal;font-style:normal;border:medium none;color:rgb(153, 153, 153);">{</span>
    <span style="margin:0px;padding:0px;list-style-type:none;text-align:left;text-decoration:none;font-weight:normal;font-style:normal;border:medium none;color:rgb(0, 119, 170);">var</span> buffer <span style="margin:0px;padding:0px;list-style-type:none;text-align:left;text-decoration:none;font-weight:normal;font-style:normal;border:medium none;background:rgba(255, 255, 255, 0.5) none repeat scroll 0% 0%;color:rgb(166, 127, 89);background-color:rgb(204, 232, 207);">=</span> event<span style="margin:0px;padding:0px;list-style-type:none;text-align:left;text-decoration:none;font-weight:normal;font-style:normal;border:medium none;color:rgb(153, 153, 153);">.</span>data<span style="margin:0px;padding:0px;list-style-type:none;text-align:left;text-decoration:none;font-weight:normal;font-style:normal;border:medium none;color:rgb(153, 153, 153);">;</span>
    console<span style="margin:0px;padding:0px;list-style-type:none;text-align:left;text-decoration:none;font-weight:normal;font-style:normal;border:medium none;color:rgb(153, 153, 153);">.</span><span style="margin:0px;padding:0px;list-style-type:none;text-align:left;text-decoration:none;font-weight:normal;font-style:normal;border:medium none;color:rgb(17, 17, 17);">log<span style="margin:0px;padding:0px;list-style-type:none;text-align:left;text-decoration:none;font-weight:normal;font-style:normal;border:medium none;color:rgb(153, 153, 153);">(</span></span><span style="margin:0px;padding:0px;list-style-type:none;text-align:left;text-decoration:none;font-weight:normal;font-style:normal;border:medium none;color:rgb(102, 153, 0);">"Received arraybuffer"</span><span style="margin:0px;padding:0px;list-style-type:none;text-align:left;text-decoration:none;font-weight:normal;font-style:normal;border:medium none;color:rgb(153, 153, 153);">)</span><span style="margin:0px;padding:0px;list-style-type:none;text-align:left;text-decoration:none;font-weight:normal;font-style:normal;border:medium none;color:rgb(153, 153, 153);">;</span>
  <span style="margin:0px;padding:0px;list-style-type:none;text-align:left;text-decoration:none;font-weight:normal;font-style:normal;border:medium none;color:rgb(153, 153, 153);">}</span>
<span style="margin:0px;padding:0px;list-style-type:none;text-align:left;text-decoration:none;font-weight:normal;font-style:normal;border:medium none;color:rgb(153, 153, 153);">}</span>
</code></pre></blockquote>

<p style="margin:0px;padding:0px;list-style-type:none;text-align:left;text-decoration:none;font-weight:normal;font-style:normal;border:medium none;color:rgb(17, 17, 17);font-size:1.6em;margin-top:1em;margin-left:0.8em;line-height:180%;">除了动态判断收到的数据类型，也可以使用<code style="padding:0px;list-style-type:none;text-align:left;text-decoration:none;font-weight:normal;font-style:normal;border:medium none;color:rgb(17, 17, 17);display:inline-block;padding-left:5px;padding-right:5px;font-size:120%;background-color:pink;border-radius:5px;margin:auto 3px;">binaryType</code>属性，显式指定收到的二进制数据类型。</p>

<blockquote style="list-style-type:none;text-align:left;text-decoration:none;font-weight:normal;font-style:normal;border:medium none;color:rgb(17, 17, 17);background-color:rgb(245, 242, 240);border-radius:1em;font-family:Consolas, Monaco, &quot;Andale Mono&quot;, monospace;border-width:0.3em;border-color:rgb(224, 223, 204);border-style:solid;text-shadow:white 0px 1px;overflow:auto;margin:2em;padding:1em;"><pre style="margin:0px;list-style-type:none;text-decoration:none;font-weight:normal;font-style:normal;border:medium none;text-shadow:white 0px 1px;font-family:monospace, Consolas, Monaco, &quot;Andale Mono&quot;;direction:ltr;white-space:pre;word-spacing:normal;font-size:1.2em;hyphens:none;text-align:left;color:black;overflow:auto;padding:0em 0em 0.5em;background:rgb(245, 242, 240) none repeat scroll 0% 0%;" xml:space="preserve"><code style="margin:0px;padding:0px;list-style-type:none;text-decoration:none;font-weight:normal;font-style:normal;border:medium none;text-shadow:white 0px 1px;font-family:monospace, Consolas, Monaco, &quot;Andale Mono&quot;;direction:ltr;white-space:pre;word-spacing:normal;font-size:1.2em;hyphens:none;text-align:left;color:black;"><span style="margin:0px;padding:0px;list-style-type:none;text-align:left;text-decoration:none;font-weight:normal;font-style:normal;border:medium none;color:slategray;">
// 收到的是 blob 数据
</span>ws<span style="margin:0px;padding:0px;list-style-type:none;text-align:left;text-decoration:none;font-weight:normal;font-style:normal;border:medium none;color:rgb(153, 153, 153);">.</span>binaryType <span style="margin:0px;padding:0px;list-style-type:none;text-align:left;text-decoration:none;font-weight:normal;font-style:normal;border:medium none;background:rgba(255, 255, 255, 0.5) none repeat scroll 0% 0%;color:rgb(166, 127, 89);background-color:rgb(204, 232, 207);">=</span> <span style="margin:0px;padding:0px;list-style-type:none;text-align:left;text-decoration:none;font-weight:normal;font-style:normal;border:medium none;color:rgb(102, 153, 0);">"blob"</span><span style="margin:0px;padding:0px;list-style-type:none;text-align:left;text-decoration:none;font-weight:normal;font-style:normal;border:medium none;color:rgb(153, 153, 153);">;</span>
ws<span style="margin:0px;padding:0px;list-style-type:none;text-align:left;text-decoration:none;font-weight:normal;font-style:normal;border:medium none;color:rgb(153, 153, 153);">.</span>onmessage <span style="margin:0px;padding:0px;list-style-type:none;text-align:left;text-decoration:none;font-weight:normal;font-style:normal;border:medium none;background:rgba(255, 255, 255, 0.5) none repeat scroll 0% 0%;color:rgb(166, 127, 89);background-color:rgb(204, 232, 207);">=</span> <span style="margin:0px;padding:0px;list-style-type:none;text-align:left;text-decoration:none;font-weight:normal;font-style:normal;border:medium none;color:rgb(0, 119, 170);">function</span><span style="margin:0px;padding:0px;list-style-type:none;text-align:left;text-decoration:none;font-weight:normal;font-style:normal;border:medium none;color:rgb(153, 153, 153);">(</span>e<span style="margin:0px;padding:0px;list-style-type:none;text-align:left;text-decoration:none;font-weight:normal;font-style:normal;border:medium none;color:rgb(153, 153, 153);">)</span> <span style="margin:0px;padding:0px;list-style-type:none;text-align:left;text-decoration:none;font-weight:normal;font-style:normal;border:medium none;color:rgb(153, 153, 153);">{</span>
  console<span style="margin:0px;padding:0px;list-style-type:none;text-align:left;text-decoration:none;font-weight:normal;font-style:normal;border:medium none;color:rgb(153, 153, 153);">.</span><span style="margin:0px;padding:0px;list-style-type:none;text-align:left;text-decoration:none;font-weight:normal;font-style:normal;border:medium none;color:rgb(17, 17, 17);">log<span style="margin:0px;padding:0px;list-style-type:none;text-align:left;text-decoration:none;font-weight:normal;font-style:normal;border:medium none;color:rgb(153, 153, 153);">(</span></span>e<span style="margin:0px;padding:0px;list-style-type:none;text-align:left;text-decoration:none;font-weight:normal;font-style:normal;border:medium none;color:rgb(153, 153, 153);">.</span>data<span style="margin:0px;padding:0px;list-style-type:none;text-align:left;text-decoration:none;font-weight:normal;font-style:normal;border:medium none;color:rgb(153, 153, 153);">.</span>size<span style="margin:0px;padding:0px;list-style-type:none;text-align:left;text-decoration:none;font-weight:normal;font-style:normal;border:medium none;color:rgb(153, 153, 153);">)</span><span style="margin:0px;padding:0px;list-style-type:none;text-align:left;text-decoration:none;font-weight:normal;font-style:normal;border:medium none;color:rgb(153, 153, 153);">;</span>
<span style="margin:0px;padding:0px;list-style-type:none;text-align:left;text-decoration:none;font-weight:normal;font-style:normal;border:medium none;color:rgb(153, 153, 153);">}</span><span style="margin:0px;padding:0px;list-style-type:none;text-align:left;text-decoration:none;font-weight:normal;font-style:normal;border:medium none;color:rgb(153, 153, 153);">;</span>
<span style="margin:0px;padding:0px;list-style-type:none;text-align:left;text-decoration:none;font-weight:normal;font-style:normal;border:medium none;color:slategray;">
// 收到的是 ArrayBuffer 数据
</span>ws<span style="margin:0px;padding:0px;list-style-type:none;text-align:left;text-decoration:none;font-weight:normal;font-style:normal;border:medium none;color:rgb(153, 153, 153);">.</span>binaryType <span style="margin:0px;padding:0px;list-style-type:none;text-align:left;text-decoration:none;font-weight:normal;font-style:normal;border:medium none;background:rgba(255, 255, 255, 0.5) none repeat scroll 0% 0%;color:rgb(166, 127, 89);background-color:rgb(204, 232, 207);">=</span> <span style="margin:0px;padding:0px;list-style-type:none;text-align:left;text-decoration:none;font-weight:normal;font-style:normal;border:medium none;color:rgb(102, 153, 0);">"arraybuffer"</span><span style="margin:0px;padding:0px;list-style-type:none;text-align:left;text-decoration:none;font-weight:normal;font-style:normal;border:medium none;color:rgb(153, 153, 153);">;</span>
ws<span style="margin:0px;padding:0px;list-style-type:none;text-align:left;text-decoration:none;font-weight:normal;font-style:normal;border:medium none;color:rgb(153, 153, 153);">.</span>onmessage <span style="margin:0px;padding:0px;list-style-type:none;text-align:left;text-decoration:none;font-weight:normal;font-style:normal;border:medium none;background:rgba(255, 255, 255, 0.5) none repeat scroll 0% 0%;color:rgb(166, 127, 89);background-color:rgb(204, 232, 207);">=</span> <span style="margin:0px;padding:0px;list-style-type:none;text-align:left;text-decoration:none;font-weight:normal;font-style:normal;border:medium none;color:rgb(0, 119, 170);">function</span><span style="margin:0px;padding:0px;list-style-type:none;text-align:left;text-decoration:none;font-weight:normal;font-style:normal;border:medium none;color:rgb(153, 153, 153);">(</span>e<span style="margin:0px;padding:0px;list-style-type:none;text-align:left;text-decoration:none;font-weight:normal;font-style:normal;border:medium none;color:rgb(153, 153, 153);">)</span> <span style="margin:0px;padding:0px;list-style-type:none;text-align:left;text-decoration:none;font-weight:normal;font-style:normal;border:medium none;color:rgb(153, 153, 153);">{</span>
  console<span style="margin:0px;padding:0px;list-style-type:none;text-align:left;text-decoration:none;font-weight:normal;font-style:normal;border:medium none;color:rgb(153, 153, 153);">.</span><span style="margin:0px;padding:0px;list-style-type:none;text-align:left;text-decoration:none;font-weight:normal;font-style:normal;border:medium none;color:rgb(17, 17, 17);">log<span style="margin:0px;padding:0px;list-style-type:none;text-align:left;text-decoration:none;font-weight:normal;font-style:normal;border:medium none;color:rgb(153, 153, 153);">(</span></span>e<span style="margin:0px;padding:0px;list-style-type:none;text-align:left;text-decoration:none;font-weight:normal;font-style:normal;border:medium none;color:rgb(153, 153, 153);">.</span>data<span style="margin:0px;padding:0px;list-style-type:none;text-align:left;text-decoration:none;font-weight:normal;font-style:normal;border:medium none;color:rgb(153, 153, 153);">.</span>byteLength<span style="margin:0px;padding:0px;list-style-type:none;text-align:left;text-decoration:none;font-weight:normal;font-style:normal;border:medium none;color:rgb(153, 153, 153);">)</span><span style="margin:0px;padding:0px;list-style-type:none;text-align:left;text-decoration:none;font-weight:normal;font-style:normal;border:medium none;color:rgb(153, 153, 153);">;</span>
<span style="margin:0px;padding:0px;list-style-type:none;text-align:left;text-decoration:none;font-weight:normal;font-style:normal;border:medium none;color:rgb(153, 153, 153);">}</span><span style="margin:0px;padding:0px;list-style-type:none;text-align:left;text-decoration:none;font-weight:normal;font-style:normal;border:medium none;color:rgb(153, 153, 153);">;</span>
</code></pre></blockquote>

<h3 style="list-style-type:none;text-align:left;text-decoration:none;font-style:normal;border:medium none;font-size:1.87em;letter-spacing:-0.03em;border-bottom:1px solid rgb(211, 211, 211);margin:0.4em 0px 0.2em;padding:0px 0px 0.2em;font-weight:500;color:rgb(0, 0, 0);margin-top:1.5em;">4.6 webSocket.send()</h3>

<p style="margin:0px;padding:0px;list-style-type:none;text-align:left;text-decoration:none;font-weight:normal;font-style:normal;border:medium none;color:rgb(17, 17, 17);font-size:1.6em;margin-top:1em;margin-left:0.8em;line-height:180%;">实例对象的<code style="padding:0px;list-style-type:none;text-align:left;text-decoration:none;font-weight:normal;font-style:normal;border:medium none;color:rgb(17, 17, 17);display:inline-block;padding-left:5px;padding-right:5px;font-size:120%;background-color:pink;border-radius:5px;margin:auto 3px;">send()</code>方法用于向服务器发送数据。</p>

<p style="margin:0px;padding:0px;list-style-type:none;text-align:left;text-decoration:none;font-weight:normal;font-style:normal;border:medium none;color:rgb(17, 17, 17);font-size:1.6em;margin-top:1em;margin-left:0.8em;line-height:180%;">发送文本的例子。</p>

<blockquote style="list-style-type:none;text-align:left;text-decoration:none;font-weight:normal;font-style:normal;border:medium none;color:rgb(17, 17, 17);background-color:rgb(245, 242, 240);border-radius:1em;font-family:Consolas, Monaco, &quot;Andale Mono&quot;, monospace;border-width:0.3em;border-color:rgb(224, 223, 204);border-style:solid;text-shadow:white 0px 1px;overflow:auto;margin:2em;padding:1em;"><pre style="margin:0px;list-style-type:none;text-decoration:none;font-weight:normal;font-style:normal;border:medium none;text-shadow:white 0px 1px;font-family:monospace, Consolas, Monaco, &quot;Andale Mono&quot;;direction:ltr;white-space:pre;word-spacing:normal;font-size:1.2em;hyphens:none;text-align:left;color:black;overflow:auto;padding:0em 0em 0.5em;background:rgb(245, 242, 240) none repeat scroll 0% 0%;" xml:space="preserve"><code style="margin:0px;padding:0px;list-style-type:none;text-decoration:none;font-weight:normal;font-style:normal;border:medium none;text-shadow:white 0px 1px;font-family:monospace, Consolas, Monaco, &quot;Andale Mono&quot;;direction:ltr;white-space:pre;word-spacing:normal;font-size:1.2em;hyphens:none;text-align:left;color:black;">
ws<span style="margin:0px;padding:0px;list-style-type:none;text-align:left;text-decoration:none;font-weight:normal;font-style:normal;border:medium none;color:rgb(153, 153, 153);">.</span><span style="margin:0px;padding:0px;list-style-type:none;text-align:left;text-decoration:none;font-weight:normal;font-style:normal;border:medium none;color:rgb(17, 17, 17);">send<span style="margin:0px;padding:0px;list-style-type:none;text-align:left;text-decoration:none;font-weight:normal;font-style:normal;border:medium none;color:rgb(153, 153, 153);">(</span></span><span style="margin:0px;padding:0px;list-style-type:none;text-align:left;text-decoration:none;font-weight:normal;font-style:normal;border:medium none;color:rgb(102, 153, 0);">'your message'</span><span style="margin:0px;padding:0px;list-style-type:none;text-align:left;text-decoration:none;font-weight:normal;font-style:normal;border:medium none;color:rgb(153, 153, 153);">)</span><span style="margin:0px;padding:0px;list-style-type:none;text-align:left;text-decoration:none;font-weight:normal;font-style:normal;border:medium none;color:rgb(153, 153, 153);">;</span>
</code></pre></blockquote>

<p style="margin:0px;padding:0px;list-style-type:none;text-align:left;text-decoration:none;font-weight:normal;font-style:normal;border:medium none;color:rgb(17, 17, 17);font-size:1.6em;margin-top:1em;margin-left:0.8em;line-height:180%;">发送 Blob 对象的例子。</p>

<blockquote style="list-style-type:none;text-align:left;text-decoration:none;font-weight:normal;font-style:normal;border:medium none;color:rgb(17, 17, 17);background-color:rgb(245, 242, 240);border-radius:1em;font-family:Consolas, Monaco, &quot;Andale Mono&quot;, monospace;border-width:0.3em;border-color:rgb(224, 223, 204);border-style:solid;text-shadow:white 0px 1px;overflow:auto;margin:2em;padding:1em;"><pre style="margin:0px;list-style-type:none;text-decoration:none;font-weight:normal;font-style:normal;border:medium none;text-shadow:white 0px 1px;font-family:monospace, Consolas, Monaco, &quot;Andale Mono&quot;;direction:ltr;white-space:pre;word-spacing:normal;font-size:1.2em;hyphens:none;text-align:left;color:black;overflow:auto;padding:0em 0em 0.5em;background:rgb(245, 242, 240) none repeat scroll 0% 0%;" xml:space="preserve"><code style="margin:0px;padding:0px;list-style-type:none;text-decoration:none;font-weight:normal;font-style:normal;border:medium none;text-shadow:white 0px 1px;font-family:monospace, Consolas, Monaco, &quot;Andale Mono&quot;;direction:ltr;white-space:pre;word-spacing:normal;font-size:1.2em;hyphens:none;text-align:left;color:black;">
<span style="margin:0px;padding:0px;list-style-type:none;text-align:left;text-decoration:none;font-weight:normal;font-style:normal;border:medium none;color:rgb(0, 119, 170);">var</span> file <span style="margin:0px;padding:0px;list-style-type:none;text-align:left;text-decoration:none;font-weight:normal;font-style:normal;border:medium none;background:rgba(255, 255, 255, 0.5) none repeat scroll 0% 0%;color:rgb(166, 127, 89);background-color:rgb(204, 232, 207);">=</span> document
  <span style="margin:0px;padding:0px;list-style-type:none;text-align:left;text-decoration:none;font-weight:normal;font-style:normal;border:medium none;color:rgb(153, 153, 153);">.</span><span style="margin:0px;padding:0px;list-style-type:none;text-align:left;text-decoration:none;font-weight:normal;font-style:normal;border:medium none;color:rgb(17, 17, 17);">querySelector<span style="margin:0px;padding:0px;list-style-type:none;text-align:left;text-decoration:none;font-weight:normal;font-style:normal;border:medium none;color:rgb(153, 153, 153);">(</span></span><span style="margin:0px;padding:0px;list-style-type:none;text-align:left;text-decoration:none;font-weight:normal;font-style:normal;border:medium none;color:rgb(102, 153, 0);">'input[type="file"]'</span><span style="margin:0px;padding:0px;list-style-type:none;text-align:left;text-decoration:none;font-weight:normal;font-style:normal;border:medium none;color:rgb(153, 153, 153);">)</span>
  <span style="margin:0px;padding:0px;list-style-type:none;text-align:left;text-decoration:none;font-weight:normal;font-style:normal;border:medium none;color:rgb(153, 153, 153);">.</span>files<span style="margin:0px;padding:0px;list-style-type:none;text-align:left;text-decoration:none;font-weight:normal;font-style:normal;border:medium none;color:rgb(153, 153, 153);">[</span><span style="margin:0px;padding:0px;list-style-type:none;text-align:left;text-decoration:none;font-weight:normal;font-style:normal;border:medium none;color:rgb(153, 0, 85);">0</span><span style="margin:0px;padding:0px;list-style-type:none;text-align:left;text-decoration:none;font-weight:normal;font-style:normal;border:medium none;color:rgb(153, 153, 153);">]</span><span style="margin:0px;padding:0px;list-style-type:none;text-align:left;text-decoration:none;font-weight:normal;font-style:normal;border:medium none;color:rgb(153, 153, 153);">;</span>
ws<span style="margin:0px;padding:0px;list-style-type:none;text-align:left;text-decoration:none;font-weight:normal;font-style:normal;border:medium none;color:rgb(153, 153, 153);">.</span><span style="margin:0px;padding:0px;list-style-type:none;text-align:left;text-decoration:none;font-weight:normal;font-style:normal;border:medium none;color:rgb(17, 17, 17);">send<span style="margin:0px;padding:0px;list-style-type:none;text-align:left;text-decoration:none;font-weight:normal;font-style:normal;border:medium none;color:rgb(153, 153, 153);">(</span></span>file<span style="margin:0px;padding:0px;list-style-type:none;text-align:left;text-decoration:none;font-weight:normal;font-style:normal;border:medium none;color:rgb(153, 153, 153);">)</span><span style="margin:0px;padding:0px;list-style-type:none;text-align:left;text-decoration:none;font-weight:normal;font-style:normal;border:medium none;color:rgb(153, 153, 153);">;</span>
</code></pre></blockquote>

<p style="margin:0px;padding:0px;list-style-type:none;text-align:left;text-decoration:none;font-weight:normal;font-style:normal;border:medium none;color:rgb(17, 17, 17);font-size:1.6em;margin-top:1em;margin-left:0.8em;line-height:180%;">发送 ArrayBuffer 对象的例子。</p>

<blockquote style="list-style-type:none;text-align:left;text-decoration:none;font-weight:normal;font-style:normal;border:medium none;color:rgb(17, 17, 17);background-color:rgb(245, 242, 240);border-radius:1em;font-family:Consolas, Monaco, &quot;Andale Mono&quot;, monospace;border-width:0.3em;border-color:rgb(224, 223, 204);border-style:solid;text-shadow:white 0px 1px;overflow:auto;margin:2em;padding:1em;"><pre style="margin:0px;list-style-type:none;text-decoration:none;font-weight:normal;font-style:normal;border:medium none;text-shadow:white 0px 1px;font-family:monospace, Consolas, Monaco, &quot;Andale Mono&quot;;direction:ltr;white-space:pre;word-spacing:normal;font-size:1.2em;hyphens:none;text-align:left;color:black;overflow:auto;padding:0em 0em 0.5em;background:rgb(245, 242, 240) none repeat scroll 0% 0%;" xml:space="preserve"><code style="margin:0px;padding:0px;list-style-type:none;text-decoration:none;font-weight:normal;font-style:normal;border:medium none;text-shadow:white 0px 1px;font-family:monospace, Consolas, Monaco, &quot;Andale Mono&quot;;direction:ltr;white-space:pre;word-spacing:normal;font-size:1.2em;hyphens:none;text-align:left;color:black;"><span style="margin:0px;padding:0px;list-style-type:none;text-align:left;text-decoration:none;font-weight:normal;font-style:normal;border:medium none;color:slategray;">
// Sending canvas ImageData as ArrayBuffer
</span><span style="margin:0px;padding:0px;list-style-type:none;text-align:left;text-decoration:none;font-weight:normal;font-style:normal;border:medium none;color:rgb(0, 119, 170);">var</span> img <span style="margin:0px;padding:0px;list-style-type:none;text-align:left;text-decoration:none;font-weight:normal;font-style:normal;border:medium none;background:rgba(255, 255, 255, 0.5) none repeat scroll 0% 0%;color:rgb(166, 127, 89);background-color:rgb(204, 232, 207);">=</span> canvas_context<span style="margin:0px;padding:0px;list-style-type:none;text-align:left;text-decoration:none;font-weight:normal;font-style:normal;border:medium none;color:rgb(153, 153, 153);">.</span><span style="margin:0px;padding:0px;list-style-type:none;text-align:left;text-decoration:none;font-weight:normal;font-style:normal;border:medium none;color:rgb(17, 17, 17);">getImageData<span style="margin:0px;padding:0px;list-style-type:none;text-align:left;text-decoration:none;font-weight:normal;font-style:normal;border:medium none;color:rgb(153, 153, 153);">(</span></span><span style="margin:0px;padding:0px;list-style-type:none;text-align:left;text-decoration:none;font-weight:normal;font-style:normal;border:medium none;color:rgb(153, 0, 85);">0</span><span style="margin:0px;padding:0px;list-style-type:none;text-align:left;text-decoration:none;font-weight:normal;font-style:normal;border:medium none;color:rgb(153, 153, 153);">,</span> <span style="margin:0px;padding:0px;list-style-type:none;text-align:left;text-decoration:none;font-weight:normal;font-style:normal;border:medium none;color:rgb(153, 0, 85);">0</span><span style="margin:0px;padding:0px;list-style-type:none;text-align:left;text-decoration:none;font-weight:normal;font-style:normal;border:medium none;color:rgb(153, 153, 153);">,</span> <span style="margin:0px;padding:0px;list-style-type:none;text-align:left;text-decoration:none;font-weight:normal;font-style:normal;border:medium none;color:rgb(153, 0, 85);">400</span><span style="margin:0px;padding:0px;list-style-type:none;text-align:left;text-decoration:none;font-weight:normal;font-style:normal;border:medium none;color:rgb(153, 153, 153);">,</span> <span style="margin:0px;padding:0px;list-style-type:none;text-align:left;text-decoration:none;font-weight:normal;font-style:normal;border:medium none;color:rgb(153, 0, 85);">320</span><span style="margin:0px;padding:0px;list-style-type:none;text-align:left;text-decoration:none;font-weight:normal;font-style:normal;border:medium none;color:rgb(153, 153, 153);">)</span><span style="margin:0px;padding:0px;list-style-type:none;text-align:left;text-decoration:none;font-weight:normal;font-style:normal;border:medium none;color:rgb(153, 153, 153);">;</span>
<span style="margin:0px;padding:0px;list-style-type:none;text-align:left;text-decoration:none;font-weight:normal;font-style:normal;border:medium none;color:rgb(0, 119, 170);">var</span> binary <span style="margin:0px;padding:0px;list-style-type:none;text-align:left;text-decoration:none;font-weight:normal;font-style:normal;border:medium none;background:rgba(255, 255, 255, 0.5) none repeat scroll 0% 0%;color:rgb(166, 127, 89);background-color:rgb(204, 232, 207);">=</span> <span style="margin:0px;padding:0px;list-style-type:none;text-align:left;text-decoration:none;font-weight:normal;font-style:normal;border:medium none;color:rgb(0, 119, 170);">new</span> <span style="margin:0px;padding:0px;list-style-type:none;text-align:left;text-decoration:none;font-weight:normal;font-style:normal;border:medium none;color:rgb(17, 17, 17);">Uint8Array</span><span style="margin:0px;padding:0px;list-style-type:none;text-align:left;text-decoration:none;font-weight:normal;font-style:normal;border:medium none;color:rgb(153, 153, 153);">(</span>img<span style="margin:0px;padding:0px;list-style-type:none;text-align:left;text-decoration:none;font-weight:normal;font-style:normal;border:medium none;color:rgb(153, 153, 153);">.</span>data<span style="margin:0px;padding:0px;list-style-type:none;text-align:left;text-decoration:none;font-weight:normal;font-style:normal;border:medium none;color:rgb(153, 153, 153);">.</span>length<span style="margin:0px;padding:0px;list-style-type:none;text-align:left;text-decoration:none;font-weight:normal;font-style:normal;border:medium none;color:rgb(153, 153, 153);">)</span><span style="margin:0px;padding:0px;list-style-type:none;text-align:left;text-decoration:none;font-weight:normal;font-style:normal;border:medium none;color:rgb(153, 153, 153);">;</span>
<span style="margin:0px;padding:0px;list-style-type:none;text-align:left;text-decoration:none;font-weight:normal;font-style:normal;border:medium none;color:rgb(0, 119, 170);">for</span> <span style="margin:0px;padding:0px;list-style-type:none;text-align:left;text-decoration:none;font-weight:normal;font-style:normal;border:medium none;color:rgb(153, 153, 153);">(</span><span style="margin:0px;padding:0px;list-style-type:none;text-align:left;text-decoration:none;font-weight:normal;font-style:normal;border:medium none;color:rgb(0, 119, 170);">var</span> i <span style="margin:0px;padding:0px;list-style-type:none;text-align:left;text-decoration:none;font-weight:normal;font-style:normal;border:medium none;background:rgba(255, 255, 255, 0.5) none repeat scroll 0% 0%;color:rgb(166, 127, 89);background-color:rgb(204, 232, 207);">=</span> <span style="margin:0px;padding:0px;list-style-type:none;text-align:left;text-decoration:none;font-weight:normal;font-style:normal;border:medium none;color:rgb(153, 0, 85);">0</span><span style="margin:0px;padding:0px;list-style-type:none;text-align:left;text-decoration:none;font-weight:normal;font-style:normal;border:medium none;color:rgb(153, 153, 153);">;</span> i <span style="margin:0px;padding:0px;list-style-type:none;text-align:left;text-decoration:none;font-weight:normal;font-style:normal;border:medium none;background:rgba(255, 255, 255, 0.5) none repeat scroll 0% 0%;color:rgb(166, 127, 89);background-color:rgb(204, 232, 207);">&lt;</span> img<span style="margin:0px;padding:0px;list-style-type:none;text-align:left;text-decoration:none;font-weight:normal;font-style:normal;border:medium none;color:rgb(153, 153, 153);">.</span>data<span style="margin:0px;padding:0px;list-style-type:none;text-align:left;text-decoration:none;font-weight:normal;font-style:normal;border:medium none;color:rgb(153, 153, 153);">.</span>length<span style="margin:0px;padding:0px;list-style-type:none;text-align:left;text-decoration:none;font-weight:normal;font-style:normal;border:medium none;color:rgb(153, 153, 153);">;</span> i<span style="margin:0px;padding:0px;list-style-type:none;text-align:left;text-decoration:none;font-weight:normal;font-style:normal;border:medium none;background:rgba(255, 255, 255, 0.5) none repeat scroll 0% 0%;color:rgb(166, 127, 89);background-color:rgb(204, 232, 207);">++</span><span style="margin:0px;padding:0px;list-style-type:none;text-align:left;text-decoration:none;font-weight:normal;font-style:normal;border:medium none;color:rgb(153, 153, 153);">)</span> <span style="margin:0px;padding:0px;list-style-type:none;text-align:left;text-decoration:none;font-weight:normal;font-style:normal;border:medium none;color:rgb(153, 153, 153);">{</span>
  binary<span style="margin:0px;padding:0px;list-style-type:none;text-align:left;text-decoration:none;font-weight:normal;font-style:normal;border:medium none;color:rgb(153, 153, 153);">[</span>i<span style="margin:0px;padding:0px;list-style-type:none;text-align:left;text-decoration:none;font-weight:normal;font-style:normal;border:medium none;color:rgb(153, 153, 153);">]</span> <span style="margin:0px;padding:0px;list-style-type:none;text-align:left;text-decoration:none;font-weight:normal;font-style:normal;border:medium none;background:rgba(255, 255, 255, 0.5) none repeat scroll 0% 0%;color:rgb(166, 127, 89);background-color:rgb(204, 232, 207);">=</span> img<span style="margin:0px;padding:0px;list-style-type:none;text-align:left;text-decoration:none;font-weight:normal;font-style:normal;border:medium none;color:rgb(153, 153, 153);">.</span>data<span style="margin:0px;padding:0px;list-style-type:none;text-align:left;text-decoration:none;font-weight:normal;font-style:normal;border:medium none;color:rgb(153, 153, 153);">[</span>i<span style="margin:0px;padding:0px;list-style-type:none;text-align:left;text-decoration:none;font-weight:normal;font-style:normal;border:medium none;color:rgb(153, 153, 153);">]</span><span style="margin:0px;padding:0px;list-style-type:none;text-align:left;text-decoration:none;font-weight:normal;font-style:normal;border:medium none;color:rgb(153, 153, 153);">;</span>
<span style="margin:0px;padding:0px;list-style-type:none;text-align:left;text-decoration:none;font-weight:normal;font-style:normal;border:medium none;color:rgb(153, 153, 153);">}</span>
ws<span style="margin:0px;padding:0px;list-style-type:none;text-align:left;text-decoration:none;font-weight:normal;font-style:normal;border:medium none;color:rgb(153, 153, 153);">.</span><span style="margin:0px;padding:0px;list-style-type:none;text-align:left;text-decoration:none;font-weight:normal;font-style:normal;border:medium none;color:rgb(17, 17, 17);">send<span style="margin:0px;padding:0px;list-style-type:none;text-align:left;text-decoration:none;font-weight:normal;font-style:normal;border:medium none;color:rgb(153, 153, 153);">(</span></span>binary<span style="margin:0px;padding:0px;list-style-type:none;text-align:left;text-decoration:none;font-weight:normal;font-style:normal;border:medium none;color:rgb(153, 153, 153);">.</span>buffer<span style="margin:0px;padding:0px;list-style-type:none;text-align:left;text-decoration:none;font-weight:normal;font-style:normal;border:medium none;color:rgb(153, 153, 153);">)</span><span style="margin:0px;padding:0px;list-style-type:none;text-align:left;text-decoration:none;font-weight:normal;font-style:normal;border:medium none;color:rgb(153, 153, 153);">;</span>
</code></pre></blockquote>

<h3 style="list-style-type:none;text-align:left;text-decoration:none;font-style:normal;border:medium none;font-size:1.87em;letter-spacing:-0.03em;border-bottom:1px solid rgb(211, 211, 211);margin:0.4em 0px 0.2em;padding:0px 0px 0.2em;font-weight:500;color:rgb(0, 0, 0);margin-top:1.5em;">4.7 webSocket.bufferedAmount</h3>

<p style="margin:0px;padding:0px;list-style-type:none;text-align:left;text-decoration:none;font-weight:normal;font-style:normal;border:medium none;color:rgb(17, 17, 17);font-size:1.6em;margin-top:1em;margin-left:0.8em;line-height:180%;">实例对象的<code style="padding:0px;list-style-type:none;text-align:left;text-decoration:none;font-weight:normal;font-style:normal;border:medium none;color:rgb(17, 17, 17);display:inline-block;padding-left:5px;padding-right:5px;font-size:120%;background-color:pink;border-radius:5px;margin:auto 3px;">bufferedAmount</code>属性，表示还有多少字节的二进制数据没有发送出去。它可以用来判断发送是否结束。</p>

<blockquote style="list-style-type:none;text-align:left;text-decoration:none;font-weight:normal;font-style:normal;border:medium none;color:rgb(17, 17, 17);background-color:rgb(245, 242, 240);border-radius:1em;font-family:Consolas, Monaco, &quot;Andale Mono&quot;, monospace;border-width:0.3em;border-color:rgb(224, 223, 204);border-style:solid;text-shadow:white 0px 1px;overflow:auto;margin:2em;padding:1em;"><pre style="margin:0px;list-style-type:none;text-decoration:none;font-weight:normal;font-style:normal;border:medium none;text-shadow:white 0px 1px;font-family:monospace, Consolas, Monaco, &quot;Andale Mono&quot;;direction:ltr;white-space:pre;word-spacing:normal;font-size:1.2em;hyphens:none;text-align:left;color:black;overflow:auto;padding:0em 0em 0.5em;background:rgb(245, 242, 240) none repeat scroll 0% 0%;" xml:space="preserve"><code style="margin:0px;padding:0px;list-style-type:none;text-decoration:none;font-weight:normal;font-style:normal;border:medium none;text-shadow:white 0px 1px;font-family:monospace, Consolas, Monaco, &quot;Andale Mono&quot;;direction:ltr;white-space:pre;word-spacing:normal;font-size:1.2em;hyphens:none;text-align:left;color:black;">
<span style="margin:0px;padding:0px;list-style-type:none;text-align:left;text-decoration:none;font-weight:normal;font-style:normal;border:medium none;color:rgb(0, 119, 170);">var</span> data <span style="margin:0px;padding:0px;list-style-type:none;text-align:left;text-decoration:none;font-weight:normal;font-style:normal;border:medium none;background:rgba(255, 255, 255, 0.5) none repeat scroll 0% 0%;color:rgb(166, 127, 89);background-color:rgb(204, 232, 207);">=</span> <span style="margin:0px;padding:0px;list-style-type:none;text-align:left;text-decoration:none;font-weight:normal;font-style:normal;border:medium none;color:rgb(0, 119, 170);">new</span> <span style="margin:0px;padding:0px;list-style-type:none;text-align:left;text-decoration:none;font-weight:normal;font-style:normal;border:medium none;color:rgb(17, 17, 17);">ArrayBuffer</span><span style="margin:0px;padding:0px;list-style-type:none;text-align:left;text-decoration:none;font-weight:normal;font-style:normal;border:medium none;color:rgb(153, 153, 153);">(</span><span style="margin:0px;padding:0px;list-style-type:none;text-align:left;text-decoration:none;font-weight:normal;font-style:normal;border:medium none;color:rgb(153, 0, 85);">10000000</span><span style="margin:0px;padding:0px;list-style-type:none;text-align:left;text-decoration:none;font-weight:normal;font-style:normal;border:medium none;color:rgb(153, 153, 153);">)</span><span style="margin:0px;padding:0px;list-style-type:none;text-align:left;text-decoration:none;font-weight:normal;font-style:normal;border:medium none;color:rgb(153, 153, 153);">;</span>
socket<span style="margin:0px;padding:0px;list-style-type:none;text-align:left;text-decoration:none;font-weight:normal;font-style:normal;border:medium none;color:rgb(153, 153, 153);">.</span><span style="margin:0px;padding:0px;list-style-type:none;text-align:left;text-decoration:none;font-weight:normal;font-style:normal;border:medium none;color:rgb(17, 17, 17);">send<span style="margin:0px;padding:0px;list-style-type:none;text-align:left;text-decoration:none;font-weight:normal;font-style:normal;border:medium none;color:rgb(153, 153, 153);">(</span></span>data<span style="margin:0px;padding:0px;list-style-type:none;text-align:left;text-decoration:none;font-weight:normal;font-style:normal;border:medium none;color:rgb(153, 153, 153);">)</span><span style="margin:0px;padding:0px;list-style-type:none;text-align:left;text-decoration:none;font-weight:normal;font-style:normal;border:medium none;color:rgb(153, 153, 153);">;</span>

<span style="margin:0px;padding:0px;list-style-type:none;text-align:left;text-decoration:none;font-weight:normal;font-style:normal;border:medium none;color:rgb(0, 119, 170);">if</span> <span style="margin:0px;padding:0px;list-style-type:none;text-align:left;text-decoration:none;font-weight:normal;font-style:normal;border:medium none;color:rgb(153, 153, 153);">(</span>socket<span style="margin:0px;padding:0px;list-style-type:none;text-align:left;text-decoration:none;font-weight:normal;font-style:normal;border:medium none;color:rgb(153, 153, 153);">.</span>bufferedAmount <span style="margin:0px;padding:0px;list-style-type:none;text-align:left;text-decoration:none;font-weight:normal;font-style:normal;border:medium none;background:rgba(255, 255, 255, 0.5) none repeat scroll 0% 0%;color:rgb(166, 127, 89);background-color:rgb(204, 232, 207);">===</span> <span style="margin:0px;padding:0px;list-style-type:none;text-align:left;text-decoration:none;font-weight:normal;font-style:normal;border:medium none;color:rgb(153, 0, 85);">0</span><span style="margin:0px;padding:0px;list-style-type:none;text-align:left;text-decoration:none;font-weight:normal;font-style:normal;border:medium none;color:rgb(153, 153, 153);">)</span> <span style="margin:0px;padding:0px;list-style-type:none;text-align:left;text-decoration:none;font-weight:normal;font-style:normal;border:medium none;color:rgb(153, 153, 153);">{</span>
 <span style="margin:0px;padding:0px;list-style-type:none;text-align:left;text-decoration:none;font-weight:normal;font-style:normal;border:medium none;color:slategray;"> // 发送完毕
</span><span style="margin:0px;padding:0px;list-style-type:none;text-align:left;text-decoration:none;font-weight:normal;font-style:normal;border:medium none;color:rgb(153, 153, 153);">}</span> <span style="margin:0px;padding:0px;list-style-type:none;text-align:left;text-decoration:none;font-weight:normal;font-style:normal;border:medium none;color:rgb(0, 119, 170);">else</span> <span style="margin:0px;padding:0px;list-style-type:none;text-align:left;text-decoration:none;font-weight:normal;font-style:normal;border:medium none;color:rgb(153, 153, 153);">{</span>
 <span style="margin:0px;padding:0px;list-style-type:none;text-align:left;text-decoration:none;font-weight:normal;font-style:normal;border:medium none;color:slategray;"> // 发送还没结束
</span><span style="margin:0px;padding:0px;list-style-type:none;text-align:left;text-decoration:none;font-weight:normal;font-style:normal;border:medium none;color:rgb(153, 153, 153);">}</span>
</code></pre></blockquote>

<h3 style="list-style-type:none;text-align:left;text-decoration:none;font-style:normal;border:medium none;font-size:1.87em;letter-spacing:-0.03em;border-bottom:1px solid rgb(211, 211, 211);margin:0.4em 0px 0.2em;padding:0px 0px 0.2em;font-weight:500;color:rgb(0, 0, 0);margin-top:1.5em;">4.8 webSocket.onerror</h3>

<p style="margin:0px;padding:0px;list-style-type:none;text-align:left;text-decoration:none;font-weight:normal;font-style:normal;border:medium none;color:rgb(17, 17, 17);font-size:1.6em;margin-top:1em;margin-left:0.8em;line-height:180%;">实例对象的<code style="padding:0px;list-style-type:none;text-align:left;text-decoration:none;font-weight:normal;font-style:normal;border:medium none;color:rgb(17, 17, 17);display:inline-block;padding-left:5px;padding-right:5px;font-size:120%;background-color:pink;border-radius:5px;margin:auto 3px;">onerror</code>属性，用于指定报错时的回调函数。</p>

<blockquote style="list-style-type:none;text-align:left;text-decoration:none;font-weight:normal;font-style:normal;border:medium none;color:rgb(17, 17, 17);background-color:rgb(245, 242, 240);border-radius:1em;font-family:Consolas, Monaco, &quot;Andale Mono&quot;, monospace;border-width:0.3em;border-color:rgb(224, 223, 204);border-style:solid;text-shadow:white 0px 1px;overflow:auto;margin:2em;padding:1em;"><pre style="margin:0px;list-style-type:none;text-decoration:none;font-weight:normal;font-style:normal;border:medium none;text-shadow:white 0px 1px;font-family:monospace, Consolas, Monaco, &quot;Andale Mono&quot;;direction:ltr;white-space:pre;word-spacing:normal;font-size:1.2em;hyphens:none;text-align:left;color:black;overflow:auto;padding:0em 0em 0.5em;background:rgb(245, 242, 240) none repeat scroll 0% 0%;" xml:space="preserve"><code style="margin:0px;padding:0px;list-style-type:none;text-decoration:none;font-weight:normal;font-style:normal;border:medium none;text-shadow:white 0px 1px;font-family:monospace, Consolas, Monaco, &quot;Andale Mono&quot;;direction:ltr;white-space:pre;word-spacing:normal;font-size:1.2em;hyphens:none;text-align:left;color:black;">
socket<span style="margin:0px;padding:0px;list-style-type:none;text-align:left;text-decoration:none;font-weight:normal;font-style:normal;border:medium none;color:rgb(153, 153, 153);">.</span>onerror <span style="margin:0px;padding:0px;list-style-type:none;text-align:left;text-decoration:none;font-weight:normal;font-style:normal;border:medium none;background:rgba(255, 255, 255, 0.5) none repeat scroll 0% 0%;color:rgb(166, 127, 89);background-color:rgb(204, 232, 207);">=</span> <span style="margin:0px;padding:0px;list-style-type:none;text-align:left;text-decoration:none;font-weight:normal;font-style:normal;border:medium none;color:rgb(0, 119, 170);">function</span><span style="margin:0px;padding:0px;list-style-type:none;text-align:left;text-decoration:none;font-weight:normal;font-style:normal;border:medium none;color:rgb(153, 153, 153);">(</span>event<span style="margin:0px;padding:0px;list-style-type:none;text-align:left;text-decoration:none;font-weight:normal;font-style:normal;border:medium none;color:rgb(153, 153, 153);">)</span> <span style="margin:0px;padding:0px;list-style-type:none;text-align:left;text-decoration:none;font-weight:normal;font-style:normal;border:medium none;color:rgb(153, 153, 153);">{</span>
 <span style="margin:0px;padding:0px;list-style-type:none;text-align:left;text-decoration:none;font-weight:normal;font-style:normal;border:medium none;color:slategray;"> // handle error event
</span><span style="margin:0px;padding:0px;list-style-type:none;text-align:left;text-decoration:none;font-weight:normal;font-style:normal;border:medium none;color:rgb(153, 153, 153);">}</span><span style="margin:0px;padding:0px;list-style-type:none;text-align:left;text-decoration:none;font-weight:normal;font-style:normal;border:medium none;color:rgb(153, 153, 153);">;</span>

socket<span style="margin:0px;padding:0px;list-style-type:none;text-align:left;text-decoration:none;font-weight:normal;font-style:normal;border:medium none;color:rgb(153, 153, 153);">.</span><span style="margin:0px;padding:0px;list-style-type:none;text-align:left;text-decoration:none;font-weight:normal;font-style:normal;border:medium none;color:rgb(17, 17, 17);">addEventListener<span style="margin:0px;padding:0px;list-style-type:none;text-align:left;text-decoration:none;font-weight:normal;font-style:normal;border:medium none;color:rgb(153, 153, 153);">(</span></span><span style="margin:0px;padding:0px;list-style-type:none;text-align:left;text-decoration:none;font-weight:normal;font-style:normal;border:medium none;color:rgb(102, 153, 0);">"error"</span><span style="margin:0px;padding:0px;list-style-type:none;text-align:left;text-decoration:none;font-weight:normal;font-style:normal;border:medium none;color:rgb(153, 153, 153);">,</span> <span style="margin:0px;padding:0px;list-style-type:none;text-align:left;text-decoration:none;font-weight:normal;font-style:normal;border:medium none;color:rgb(0, 119, 170);">function</span><span style="margin:0px;padding:0px;list-style-type:none;text-align:left;text-decoration:none;font-weight:normal;font-style:normal;border:medium none;color:rgb(153, 153, 153);">(</span>event<span style="margin:0px;padding:0px;list-style-type:none;text-align:left;text-decoration:none;font-weight:normal;font-style:normal;border:medium none;color:rgb(153, 153, 153);">)</span> <span style="margin:0px;padding:0px;list-style-type:none;text-align:left;text-decoration:none;font-weight:normal;font-style:normal;border:medium none;color:rgb(153, 153, 153);">{</span>
 <span style="margin:0px;padding:0px;list-style-type:none;text-align:left;text-decoration:none;font-weight:normal;font-style:normal;border:medium none;color:slategray;"> // handle error event
</span><span style="margin:0px;padding:0px;list-style-type:none;text-align:left;text-decoration:none;font-weight:normal;font-style:normal;border:medium none;color:rgb(153, 153, 153);">}</span><span style="margin:0px;padding:0px;list-style-type:none;text-align:left;text-decoration:none;font-weight:normal;font-style:normal;border:medium none;color:rgb(153, 153, 153);">)</span><span style="margin:0px;padding:0px;list-style-type:none;text-align:left;text-decoration:none;font-weight:normal;font-style:normal;border:medium none;color:rgb(153, 153, 153);">;</span>
</code></pre></blockquote>

<h2 style="list-style-type:none;text-align:left;text-decoration:none;font-style:normal;border:medium none;font-size:2.88em;line-height:1.35em;letter-spacing:-0.03em;border-bottom:1px solid rgb(211, 211, 211);margin:0.4em 0px 0.2em;padding:0px 0px 0.2em;font-weight:500;color:rgb(0, 0, 0);margin-top:1.5em;">五、服务端的实现</h2>

<p style="margin:0px;padding:0px;list-style-type:none;text-align:left;text-decoration:none;font-weight:normal;font-style:normal;border:medium none;color:rgb(17, 17, 17);font-size:1.6em;margin-top:1em;margin-left:0.8em;line-height:180%;">WebSocket 服务器的实现，可以查看维基百科的<a href="https://en.wikipedia.org/wiki/Comparison_of_WebSocket_implementations" target="_blank" style="margin:0px;padding:0px;list-style-type:none;text-align:left;font-weight:normal;font-style:normal;border:medium none;text-decoration:underline;color:rgb(34, 52, 114);">列表</a>。</p>

<p style="margin:0px;padding:0px;list-style-type:none;text-align:left;text-decoration:none;font-weight:normal;font-style:normal;border:medium none;color:rgb(17, 17, 17);font-size:1.6em;margin-top:1em;margin-left:0.8em;line-height:180%;">常用的 Node 实现有以下三种。</p>

<ul style="margin:0px;padding:0px;list-style-type:none;text-align:left;text-decoration:none;font-weight:normal;font-style:normal;border:medium none;color:rgb(17, 17, 17);margin-left:4em;">
<li style="margin:0px;padding:0px;text-align:left;text-decoration:none;font-weight:normal;font-style:normal;border:medium none;color:rgb(17, 17, 17);font-size:1.6em;line-height:220%;list-style-type:square;"><a href="https://github.com/uWebSockets/uWebSockets" target="_blank" style="margin:0px;padding:0px;list-style-type:none;text-align:left;font-weight:normal;font-style:normal;border:medium none;text-decoration:underline;color:rgb(34, 52, 114);">µWebSockets</a></li>
<li style="margin:0px;padding:0px;text-align:left;text-decoration:none;font-weight:normal;font-style:normal;border:medium none;color:rgb(17, 17, 17);font-size:1.6em;line-height:220%;list-style-type:square;"><a href="http://socket.io/" target="_blank" style="margin:0px;padding:0px;list-style-type:none;text-align:left;font-weight:normal;font-style:normal;border:medium none;text-decoration:underline;color:rgb(34, 52, 114);">Socket.IO</a></li>
<li style="margin:0px;padding:0px;text-align:left;text-decoration:none;font-weight:normal;font-style:normal;border:medium none;color:rgb(17, 17, 17);font-size:1.6em;line-height:220%;list-style-type:square;"><a href="https://github.com/theturtle32/WebSocket-Node" target="_blank" style="margin:0px;padding:0px;list-style-type:none;text-align:left;font-weight:normal;font-style:normal;border:medium none;text-decoration:underline;color:rgb(34, 52, 114);">WebSocket-Node</a></li>
</ul>

<p style="margin:0px;padding:0px;list-style-type:none;text-align:left;text-decoration:none;font-weight:normal;font-style:normal;border:medium none;color:rgb(17, 17, 17);font-size:1.6em;margin-top:1em;margin-left:0.8em;line-height:180%;">具体的用法请查看它们的文档，这里不详细介绍了。</p>

<h2 style="list-style-type:none;text-align:left;text-decoration:none;font-style:normal;border:medium none;font-size:2.88em;line-height:1.35em;letter-spacing:-0.03em;border-bottom:1px solid rgb(211, 211, 211);margin:0.4em 0px 0.2em;padding:0px 0px 0.2em;font-weight:500;color:rgb(0, 0, 0);margin-top:1.5em;">六、WebSocketd</h2>

<p style="margin:0px;padding:0px;list-style-type:none;text-align:left;text-decoration:none;font-weight:normal;font-style:normal;border:medium none;color:rgb(17, 17, 17);font-size:1.6em;margin-top:1em;margin-left:0.8em;line-height:180%;">下面，我要推荐一款非常特别的 WebSocket 服务器：<a href="http://websocketd.com/" target="_blank" style="margin:0px;padding:0px;list-style-type:none;text-align:left;font-weight:normal;font-style:normal;border:medium none;text-decoration:underline;color:rgb(34, 52, 114);">Websocketd</a>。</p>

<p style="margin:0px;padding:0px;list-style-type:none;text-align:left;text-decoration:none;font-weight:normal;font-style:normal;border:medium none;color:rgb(17, 17, 17);font-size:1.6em;margin-top:1em;margin-left:0.8em;line-height:180%;">它的最大特点，就是后台脚本不限语言，标准输入（stdin）就是 WebSocket 的输入，标准输出（stdout）就是 WebSocket 的输出。</p>

<p style="margin:0px;padding:0px;list-style-type:none;text-align:left;text-decoration:none;font-weight:normal;font-style:normal;border:medium none;color:rgb(17, 17, 17);font-size:1.6em;margin-top:1em;margin-left:0.8em;line-height:180%;"><img title="" width="600" height="289" style="margin:0px;padding:0px;list-style-type:none;text-align:left;text-decoration:none;font-weight:normal;font-style:normal;color:rgb(17, 17, 17);border-radius:1em;border:0.3em solid rgb(224, 223, 204);" src="https://app.yinxiang.com/files/common-services/binary-datas/c2VydmljZVR5cGU9MiZzZXJ2aWNlRGF0YT17Im5vdGVHdWlkIjoiOTk1YTQ0NjgtZDliMi00MGFiLTg2NTEtNmFjNTE3ODA4MWVmIiwicmVzb3VyY0d1aWQiOiJhNGQzNGFhMS1jYWEwLTRkZGYtYjQ1MS0zY2IwYTc5N2MzODYifQ==" data-original-width="600" mime="image/png" data-original-height="289" id="f7114b87950d142703701e601b8b9881" class="en-media"></p>

<p style="margin:0px;padding:0px;list-style-type:none;text-align:left;text-decoration:none;font-weight:normal;font-style:normal;border:medium none;color:rgb(17, 17, 17);font-size:1.6em;margin-top:1em;margin-left:0.8em;line-height:180%;">举例来说，下面是一个 Bash 脚本<code style="padding:0px;list-style-type:none;text-align:left;text-decoration:none;font-weight:normal;font-style:normal;border:medium none;color:rgb(17, 17, 17);display:inline-block;padding-left:5px;padding-right:5px;font-size:120%;background-color:pink;border-radius:5px;margin:auto 3px;">counter.sh</code>。</p>

<blockquote style="list-style-type:none;text-align:left;text-decoration:none;font-weight:normal;font-style:normal;border:medium none;color:rgb(17, 17, 17);background-color:rgb(245, 242, 240);border-radius:1em;font-family:Consolas, Monaco, &quot;Andale Mono&quot;, monospace;border-width:0.3em;border-color:rgb(224, 223, 204);border-style:solid;text-shadow:white 0px 1px;overflow:auto;margin:2em;padding:1em;"><pre style="margin:0px;list-style-type:none;text-decoration:none;font-weight:normal;font-style:normal;border:medium none;text-shadow:white 0px 1px;font-family:monospace, Consolas, Monaco, &quot;Andale Mono&quot;;direction:ltr;white-space:pre;word-spacing:normal;font-size:1.2em;hyphens:none;text-align:left;color:black;overflow:auto;padding:0em 0em 0.5em;background:rgb(245, 242, 240) none repeat scroll 0% 0%;" xml:space="preserve"><code style="margin:0px;padding:0px;list-style-type:none;text-decoration:none;font-weight:normal;font-style:normal;border:medium none;text-shadow:white 0px 1px;font-family:monospace, Consolas, Monaco, &quot;Andale Mono&quot;;direction:ltr;white-space:pre;word-spacing:normal;font-size:1.2em;hyphens:none;text-align:left;color:black;">
<span style="margin:0px;padding:0px;list-style-type:none;text-align:left;text-decoration:none;font-weight:normal;font-style:normal;border:medium none;color:slategray;">#!/bin/bash
</span>
<span style="margin:0px;padding:0px;list-style-type:none;text-align:left;text-decoration:none;font-weight:normal;font-style:normal;border:medium none;color:rgb(0, 119, 170);">echo</span> <span style="margin:0px;padding:0px;list-style-type:none;text-align:left;text-decoration:none;font-weight:normal;font-style:normal;border:medium none;color:rgb(153, 0, 85);">1</span>
sleep <span style="margin:0px;padding:0px;list-style-type:none;text-align:left;text-decoration:none;font-weight:normal;font-style:normal;border:medium none;color:rgb(153, 0, 85);">1</span>

<span style="margin:0px;padding:0px;list-style-type:none;text-align:left;text-decoration:none;font-weight:normal;font-style:normal;border:medium none;color:rgb(0, 119, 170);">echo</span> <span style="margin:0px;padding:0px;list-style-type:none;text-align:left;text-decoration:none;font-weight:normal;font-style:normal;border:medium none;color:rgb(153, 0, 85);">2</span>
sleep <span style="margin:0px;padding:0px;list-style-type:none;text-align:left;text-decoration:none;font-weight:normal;font-style:normal;border:medium none;color:rgb(153, 0, 85);">1</span>

<span style="margin:0px;padding:0px;list-style-type:none;text-align:left;text-decoration:none;font-weight:normal;font-style:normal;border:medium none;color:rgb(0, 119, 170);">echo</span> <span style="margin:0px;padding:0px;list-style-type:none;text-align:left;text-decoration:none;font-weight:normal;font-style:normal;border:medium none;color:rgb(153, 0, 85);">3</span>
</code></pre></blockquote>

<p style="margin:0px;padding:0px;list-style-type:none;text-align:left;text-decoration:none;font-weight:normal;font-style:normal;border:medium none;color:rgb(17, 17, 17);font-size:1.6em;margin-top:1em;margin-left:0.8em;line-height:180%;">命令行下运行这个脚本，会输出1、2、3，每个值之间间隔1秒。</p>

<blockquote style="list-style-type:none;text-align:left;text-decoration:none;font-weight:normal;font-style:normal;border:medium none;color:rgb(17, 17, 17);background-color:rgb(245, 242, 240);border-radius:1em;font-family:Consolas, Monaco, &quot;Andale Mono&quot;, monospace;border-width:0.3em;border-color:rgb(224, 223, 204);border-style:solid;text-shadow:white 0px 1px;overflow:auto;margin:2em;padding:1em;"><pre style="margin:0px;list-style-type:none;text-decoration:none;font-weight:normal;font-style:normal;border:medium none;text-shadow:white 0px 1px;font-family:monospace, Consolas, Monaco, &quot;Andale Mono&quot;;direction:ltr;white-space:pre;word-spacing:normal;font-size:1.2em;hyphens:none;text-align:left;color:black;overflow:auto;padding:0em 0em 0.5em;background:rgb(245, 242, 240) none repeat scroll 0% 0%;" xml:space="preserve"><code style="margin:0px;padding:0px;list-style-type:none;text-decoration:none;font-weight:normal;font-style:normal;border:medium none;text-shadow:white 0px 1px;font-family:monospace, Consolas, Monaco, &quot;Andale Mono&quot;;direction:ltr;white-space:pre;word-spacing:normal;font-size:1.2em;hyphens:none;text-align:left;color:black;">
$ bash <span style="margin:0px;padding:0px;list-style-type:none;text-align:left;text-decoration:none;font-weight:normal;font-style:normal;border:medium none;color:rgb(153, 153, 153);">.</span><span style="margin:0px;padding:0px;list-style-type:none;text-align:left;text-decoration:none;font-weight:normal;font-style:normal;border:medium none;background:rgba(255, 255, 255, 0.5) none repeat scroll 0% 0%;color:rgb(166, 127, 89);background-color:rgb(204, 232, 207);">/</span>counter<span style="margin:0px;padding:0px;list-style-type:none;text-align:left;text-decoration:none;font-weight:normal;font-style:normal;border:medium none;color:rgb(153, 153, 153);">.</span>sh
<span style="margin:0px;padding:0px;list-style-type:none;text-align:left;text-decoration:none;font-weight:normal;font-style:normal;border:medium none;color:rgb(153, 0, 85);">1</span>
<span style="margin:0px;padding:0px;list-style-type:none;text-align:left;text-decoration:none;font-weight:normal;font-style:normal;border:medium none;color:rgb(153, 0, 85);">2</span>
<span style="margin:0px;padding:0px;list-style-type:none;text-align:left;text-decoration:none;font-weight:normal;font-style:normal;border:medium none;color:rgb(153, 0, 85);">3</span>
</code></pre></blockquote>

<p style="margin:0px;padding:0px;list-style-type:none;text-align:left;text-decoration:none;font-weight:normal;font-style:normal;border:medium none;color:rgb(17, 17, 17);font-size:1.6em;margin-top:1em;margin-left:0.8em;line-height:180%;">现在，启动<code style="padding:0px;list-style-type:none;text-align:left;text-decoration:none;font-weight:normal;font-style:normal;border:medium none;color:rgb(17, 17, 17);display:inline-block;padding-left:5px;padding-right:5px;font-size:120%;background-color:pink;border-radius:5px;margin:auto 3px;">websocketd</code>，指定这个脚本作为服务。</p>

<blockquote style="list-style-type:none;text-align:left;text-decoration:none;font-weight:normal;font-style:normal;border:medium none;color:rgb(17, 17, 17);background-color:rgb(245, 242, 240);border-radius:1em;font-family:Consolas, Monaco, &quot;Andale Mono&quot;, monospace;border-width:0.3em;border-color:rgb(224, 223, 204);border-style:solid;text-shadow:white 0px 1px;overflow:auto;margin:2em;padding:1em;"><pre style="margin:0px;list-style-type:none;text-decoration:none;font-weight:normal;font-style:normal;border:medium none;text-shadow:white 0px 1px;font-family:monospace, Consolas, Monaco, &quot;Andale Mono&quot;;direction:ltr;white-space:pre;word-spacing:normal;font-size:1.2em;hyphens:none;text-align:left;color:black;overflow:auto;padding:0em 0em 0.5em;background:rgb(245, 242, 240) none repeat scroll 0% 0%;" xml:space="preserve"><code style="margin:0px;padding:0px;list-style-type:none;text-decoration:none;font-weight:normal;font-style:normal;border:medium none;text-shadow:white 0px 1px;font-family:monospace, Consolas, Monaco, &quot;Andale Mono&quot;;direction:ltr;white-space:pre;word-spacing:normal;font-size:1.2em;hyphens:none;text-align:left;color:black;">
$ websocketd <span style="margin:0px;padding:0px;list-style-type:none;text-align:left;text-decoration:none;font-weight:normal;font-style:normal;border:medium none;background:rgba(255, 255, 255, 0.5) none repeat scroll 0% 0%;color:rgb(166, 127, 89);background-color:rgb(204, 232, 207);">--</span>port<span style="margin:0px;padding:0px;list-style-type:none;text-align:left;text-decoration:none;font-weight:normal;font-style:normal;border:medium none;background:rgba(255, 255, 255, 0.5) none repeat scroll 0% 0%;color:rgb(166, 127, 89);background-color:rgb(204, 232, 207);">=</span><span style="margin:0px;padding:0px;list-style-type:none;text-align:left;text-decoration:none;font-weight:normal;font-style:normal;border:medium none;color:rgb(153, 0, 85);">8080</span> bash <span style="margin:0px;padding:0px;list-style-type:none;text-align:left;text-decoration:none;font-weight:normal;font-style:normal;border:medium none;color:rgb(153, 153, 153);">.</span><span style="margin:0px;padding:0px;list-style-type:none;text-align:left;text-decoration:none;font-weight:normal;font-style:normal;border:medium none;background:rgba(255, 255, 255, 0.5) none repeat scroll 0% 0%;color:rgb(166, 127, 89);background-color:rgb(204, 232, 207);">/</span>counter<span style="margin:0px;padding:0px;list-style-type:none;text-align:left;text-decoration:none;font-weight:normal;font-style:normal;border:medium none;color:rgb(153, 153, 153);">.</span>sh
</code></pre></blockquote>

<p style="margin:0px;padding:0px;list-style-type:none;text-align:left;text-decoration:none;font-weight:normal;font-style:normal;border:medium none;color:rgb(17, 17, 17);font-size:1.6em;margin-top:1em;margin-left:0.8em;line-height:180%;">上面的命令会启动一个 WebSocket 服务器，端口是<code style="padding:0px;list-style-type:none;text-align:left;text-decoration:none;font-weight:normal;font-style:normal;border:medium none;color:rgb(17, 17, 17);display:inline-block;padding-left:5px;padding-right:5px;font-size:120%;background-color:pink;border-radius:5px;margin:auto 3px;">8080</code>。每当客户端连接这个服务器，就会执行<code style="padding:0px;list-style-type:none;text-align:left;text-decoration:none;font-weight:normal;font-style:normal;border:medium none;color:rgb(17, 17, 17);display:inline-block;padding-left:5px;padding-right:5px;font-size:120%;background-color:pink;border-radius:5px;margin:auto 3px;">counter.sh</code>脚本，并将它的输出推送给客户端。</p>

<blockquote style="list-style-type:none;text-align:left;text-decoration:none;font-weight:normal;font-style:normal;border:medium none;color:rgb(17, 17, 17);background-color:rgb(245, 242, 240);border-radius:1em;font-family:Consolas, Monaco, &quot;Andale Mono&quot;, monospace;border-width:0.3em;border-color:rgb(224, 223, 204);border-style:solid;text-shadow:white 0px 1px;overflow:auto;margin:2em;padding:1em;"><pre style="margin:0px;list-style-type:none;text-decoration:none;font-weight:normal;font-style:normal;border:medium none;text-shadow:white 0px 1px;font-family:monospace, Consolas, Monaco, &quot;Andale Mono&quot;;direction:ltr;white-space:pre;word-spacing:normal;font-size:1.2em;hyphens:none;text-align:left;color:black;overflow:auto;padding:0em 0em 0.5em;background:rgb(245, 242, 240) none repeat scroll 0% 0%;" xml:space="preserve"><code style="margin:0px;padding:0px;list-style-type:none;text-decoration:none;font-weight:normal;font-style:normal;border:medium none;text-shadow:white 0px 1px;font-family:monospace, Consolas, Monaco, &quot;Andale Mono&quot;;direction:ltr;white-space:pre;word-spacing:normal;font-size:1.2em;hyphens:none;text-align:left;color:black;">
<span style="margin:0px;padding:0px;list-style-type:none;text-align:left;text-decoration:none;font-weight:normal;font-style:normal;border:medium none;color:rgb(0, 119, 170);">var</span> ws <span style="margin:0px;padding:0px;list-style-type:none;text-align:left;text-decoration:none;font-weight:normal;font-style:normal;border:medium none;background:rgba(255, 255, 255, 0.5) none repeat scroll 0% 0%;color:rgb(166, 127, 89);background-color:rgb(204, 232, 207);">=</span> <span style="margin:0px;padding:0px;list-style-type:none;text-align:left;text-decoration:none;font-weight:normal;font-style:normal;border:medium none;color:rgb(0, 119, 170);">new</span> <span style="margin:0px;padding:0px;list-style-type:none;text-align:left;text-decoration:none;font-weight:normal;font-style:normal;border:medium none;color:rgb(17, 17, 17);">WebSocket</span><span style="margin:0px;padding:0px;list-style-type:none;text-align:left;text-decoration:none;font-weight:normal;font-style:normal;border:medium none;color:rgb(153, 153, 153);">(</span><span style="margin:0px;padding:0px;list-style-type:none;text-align:left;text-decoration:none;font-weight:normal;font-style:normal;border:medium none;color:rgb(102, 153, 0);">'ws://localhost:8080/'</span><span style="margin:0px;padding:0px;list-style-type:none;text-align:left;text-decoration:none;font-weight:normal;font-style:normal;border:medium none;color:rgb(153, 153, 153);">)</span><span style="margin:0px;padding:0px;list-style-type:none;text-align:left;text-decoration:none;font-weight:normal;font-style:normal;border:medium none;color:rgb(153, 153, 153);">;</span>

ws<span style="margin:0px;padding:0px;list-style-type:none;text-align:left;text-decoration:none;font-weight:normal;font-style:normal;border:medium none;color:rgb(153, 153, 153);">.</span>onmessage <span style="margin:0px;padding:0px;list-style-type:none;text-align:left;text-decoration:none;font-weight:normal;font-style:normal;border:medium none;background:rgba(255, 255, 255, 0.5) none repeat scroll 0% 0%;color:rgb(166, 127, 89);background-color:rgb(204, 232, 207);">=</span> <span style="margin:0px;padding:0px;list-style-type:none;text-align:left;text-decoration:none;font-weight:normal;font-style:normal;border:medium none;color:rgb(0, 119, 170);">function</span><span style="margin:0px;padding:0px;list-style-type:none;text-align:left;text-decoration:none;font-weight:normal;font-style:normal;border:medium none;color:rgb(153, 153, 153);">(</span>event<span style="margin:0px;padding:0px;list-style-type:none;text-align:left;text-decoration:none;font-weight:normal;font-style:normal;border:medium none;color:rgb(153, 153, 153);">)</span> <span style="margin:0px;padding:0px;list-style-type:none;text-align:left;text-decoration:none;font-weight:normal;font-style:normal;border:medium none;color:rgb(153, 153, 153);">{</span>
  console<span style="margin:0px;padding:0px;list-style-type:none;text-align:left;text-decoration:none;font-weight:normal;font-style:normal;border:medium none;color:rgb(153, 153, 153);">.</span><span style="margin:0px;padding:0px;list-style-type:none;text-align:left;text-decoration:none;font-weight:normal;font-style:normal;border:medium none;color:rgb(17, 17, 17);">log<span style="margin:0px;padding:0px;list-style-type:none;text-align:left;text-decoration:none;font-weight:normal;font-style:normal;border:medium none;color:rgb(153, 153, 153);">(</span></span>event<span style="margin:0px;padding:0px;list-style-type:none;text-align:left;text-decoration:none;font-weight:normal;font-style:normal;border:medium none;color:rgb(153, 153, 153);">.</span>data<span style="margin:0px;padding:0px;list-style-type:none;text-align:left;text-decoration:none;font-weight:normal;font-style:normal;border:medium none;color:rgb(153, 153, 153);">)</span><span style="margin:0px;padding:0px;list-style-type:none;text-align:left;text-decoration:none;font-weight:normal;font-style:normal;border:medium none;color:rgb(153, 153, 153);">;</span>
<span style="margin:0px;padding:0px;list-style-type:none;text-align:left;text-decoration:none;font-weight:normal;font-style:normal;border:medium none;color:rgb(153, 153, 153);">}</span><span style="margin:0px;padding:0px;list-style-type:none;text-align:left;text-decoration:none;font-weight:normal;font-style:normal;border:medium none;color:rgb(153, 153, 153);">;</span>
</code></pre></blockquote>

<p style="margin:0px;padding:0px;list-style-type:none;text-align:left;text-decoration:none;font-weight:normal;font-style:normal;border:medium none;color:rgb(17, 17, 17);font-size:1.6em;margin-top:1em;margin-left:0.8em;line-height:180%;">上面是客户端的 JavaScript 代码，运行之后会在控制台依次输出1、2、3。</p>

<p style="margin:0px;padding:0px;list-style-type:none;text-align:left;text-decoration:none;font-weight:normal;font-style:normal;border:medium none;color:rgb(17, 17, 17);font-size:1.6em;margin-top:1em;margin-left:0.8em;line-height:180%;">有了它，就可以很方便地将命令行的输出，发给浏览器。</p>

<blockquote style="list-style-type:none;text-align:left;text-decoration:none;font-weight:normal;font-style:normal;border:medium none;color:rgb(17, 17, 17);background-color:rgb(245, 242, 240);border-radius:1em;font-family:Consolas, Monaco, &quot;Andale Mono&quot;, monospace;border-width:0.3em;border-color:rgb(224, 223, 204);border-style:solid;text-shadow:white 0px 1px;overflow:auto;margin:2em;padding:1em;"><pre style="margin:0px;list-style-type:none;text-decoration:none;font-weight:normal;font-style:normal;border:medium none;text-shadow:white 0px 1px;font-family:monospace, Consolas, Monaco, &quot;Andale Mono&quot;;direction:ltr;white-space:pre;word-spacing:normal;font-size:1.2em;hyphens:none;text-align:left;color:black;overflow:auto;padding:0em 0em 0.5em;background:rgb(245, 242, 240) none repeat scroll 0% 0%;" xml:space="preserve"><code style="margin:0px;padding:0px;list-style-type:none;text-decoration:none;font-weight:normal;font-style:normal;border:medium none;text-shadow:white 0px 1px;font-family:monospace, Consolas, Monaco, &quot;Andale Mono&quot;;direction:ltr;white-space:pre;word-spacing:normal;font-size:1.2em;hyphens:none;text-align:left;color:black;">
$ websocketd <span style="margin:0px;padding:0px;list-style-type:none;text-align:left;text-decoration:none;font-weight:normal;font-style:normal;border:medium none;background:rgba(255, 255, 255, 0.5) none repeat scroll 0% 0%;color:rgb(166, 127, 89);background-color:rgb(204, 232, 207);">--</span>port<span style="margin:0px;padding:0px;list-style-type:none;text-align:left;text-decoration:none;font-weight:normal;font-style:normal;border:medium none;background:rgba(255, 255, 255, 0.5) none repeat scroll 0% 0%;color:rgb(166, 127, 89);background-color:rgb(204, 232, 207);">=</span><span style="margin:0px;padding:0px;list-style-type:none;text-align:left;text-decoration:none;font-weight:normal;font-style:normal;border:medium none;color:rgb(153, 0, 85);">8080</span> ls
</code></pre></blockquote>

<p style="margin:0px;padding:0px;list-style-type:none;text-align:left;text-decoration:none;font-weight:normal;font-style:normal;border:medium none;color:rgb(17, 17, 17);font-size:1.6em;margin-top:1em;margin-left:0.8em;line-height:180%;">上面的命令会执行<code style="padding:0px;list-style-type:none;text-align:left;text-decoration:none;font-weight:normal;font-style:normal;border:medium none;color:rgb(17, 17, 17);display:inline-block;padding-left:5px;padding-right:5px;font-size:120%;background-color:pink;border-radius:5px;margin:auto 3px;">ls</code>命令，从而将当前目录的内容，发给浏览器。使用这种方式实时监控服务器，简直是轻而易举（<a href="https://github.com/joewalnes/web-vmstats" target="_blank" style="margin:0px;padding:0px;list-style-type:none;text-align:left;font-weight:normal;font-style:normal;border:medium none;text-decoration:underline;color:rgb(34, 52, 114);">代码</a>）。</p>

<p style="margin:0px;padding:0px;list-style-type:none;text-align:left;text-decoration:none;font-weight:normal;font-style:normal;border:medium none;color:rgb(17, 17, 17);font-size:1.6em;margin-top:1em;margin-left:0.8em;line-height:180%;"><img title="" width="600" height="461" style="margin:0px;padding:0px;list-style-type:none;text-align:left;text-decoration:none;font-weight:normal;font-style:normal;color:rgb(17, 17, 17);border-radius:1em;border:0.3em solid rgb(224, 223, 204);" src="https://app.yinxiang.com/files/common-services/binary-datas/c2VydmljZVR5cGU9MiZzZXJ2aWNlRGF0YT17Im5vdGVHdWlkIjoiOTk1YTQ0NjgtZDliMi00MGFiLTg2NTEtNmFjNTE3ODA4MWVmIiwicmVzb3VyY0d1aWQiOiIyNWY2MDZlNC0xYzIwLTQ0OTYtYTFjYS03NjYwNmU4MmViZGMifQ==" data-original-width="600" mime="image/png" data-original-height="461" id="a0ceb5517dc57ee27e4f4d0429172d70" class="en-media"></p>

<p style="margin:0px;padding:0px;list-style-type:none;text-align:left;text-decoration:none;font-weight:normal;font-style:normal;border:medium none;color:rgb(17, 17, 17);font-size:1.6em;margin-top:1em;margin-left:0.8em;line-height:180%;">更多的用法可以参考<a href="https://github.com/joewalnes/websocketd/tree/master/examples/bash" target="_blank" style="margin:0px;padding:0px;list-style-type:none;text-align:left;font-weight:normal;font-style:normal;border:medium none;text-decoration:underline;color:rgb(34, 52, 114);">官方示例</a>。</p>

<blockquote style="list-style-type:none;text-align:left;text-decoration:none;font-weight:normal;font-style:normal;border:medium none;color:rgb(17, 17, 17);background-color:rgb(245, 242, 240);border-radius:1em;font-family:Consolas, Monaco, &quot;Andale Mono&quot;, monospace;border-width:0.3em;border-color:rgb(224, 223, 204);border-style:solid;text-shadow:white 0px 1px;overflow:auto;margin:2em;padding:1em;">
  <ul style="margin:0px;padding:0px;list-style-type:none;text-align:left;text-decoration:none;font-weight:normal;font-style:normal;border:medium none;color:rgb(17, 17, 17);margin-left:4em;">
<li style="margin:0px;padding:0px;text-align:left;text-decoration:none;font-weight:normal;font-style:normal;border:medium none;color:rgb(17, 17, 17);font-size:1.6em;line-height:220%;list-style-type:square;">Bash 脚本<a href="https://github.com/joewalnes/websocketd/blob/master/examples/bash/greeter.sh" target="_blank" style="margin:0px;padding:0px;list-style-type:none;text-align:left;font-weight:normal;font-style:normal;border:medium none;text-decoration:underline;color:rgb(34, 52, 114);">读取客户端输入</a>的例子</li>
<li style="margin:0px;padding:0px;text-align:left;text-decoration:none;font-weight:normal;font-style:normal;border:medium none;color:rgb(17, 17, 17);font-size:1.6em;line-height:220%;list-style-type:square;">五行代码实现一个最简单的<a href="https://github.com/joewalnes/websocketd/blob/master/examples/bash/chat.sh" target="_blank" style="margin:0px;padding:0px;list-style-type:none;text-align:left;font-weight:normal;font-style:normal;border:medium none;text-decoration:underline;color:rgb(34, 52, 114);">聊天服务器</a></li>
</ul>
</blockquote>

<p style="margin:0px;padding:0px;list-style-type:none;text-align:left;text-decoration:none;font-weight:normal;font-style:normal;border:medium none;color:rgb(17, 17, 17);font-size:1.6em;margin-top:1em;margin-left:0.8em;line-height:180%;"><img title="" width="659" height="308" style="margin:0px;padding:0px;list-style-type:none;text-align:left;text-decoration:none;font-weight:normal;font-style:normal;color:rgb(17, 17, 17);border-radius:1em;border:0.3em solid rgb(224, 223, 204);" src="https://app.yinxiang.com/files/common-services/binary-datas/c2VydmljZVR5cGU9MiZzZXJ2aWNlRGF0YT17Im5vdGVHdWlkIjoiOTk1YTQ0NjgtZDliMi00MGFiLTg2NTEtNmFjNTE3ODA4MWVmIiwicmVzb3VyY0d1aWQiOiJmYzg4YzM1Yi01NGIzLTRlYjUtOWE3OS1jOTYyYjAxYTZmMzkifQ==" data-original-width="659" mime="image/png" data-original-height="308" id="4f9f8b217824bc4289f1e190a1e61a0b" class="en-media"></p>

<p style="margin:0px;padding:0px;list-style-type:none;text-align:left;text-decoration:none;font-weight:normal;font-style:normal;border:medium none;color:rgb(17, 17, 17);font-size:1.6em;margin-top:1em;margin-left:0.8em;line-height:180%;">websocketd 的实质，就是命令行的 WebSocket 代理。只要命令行可以执行的程序，都可以通过它与浏览器进行 WebSocket 通信。下面是一个 Node 实现的回声服务<a href="https://github.com/joewalnes/websocketd/blob/master/examples/nodejs/greeter.js" target="_blank" style="margin:0px;padding:0px;list-style-type:none;text-align:left;font-weight:normal;font-style:normal;border:medium none;text-decoration:underline;color:rgb(34, 52, 114);"><code style="padding:0px;list-style-type:none;text-align:left;font-weight:normal;font-style:normal;border:medium none;color:rgb(17, 17, 17);display:inline-block;padding-left:5px;padding-right:5px;font-size:120%;background-color:pink;border-radius:5px;margin:auto 3px;transition:all 1s ease 0s;text-decoration:underline;">greeter.js</code></a>。</p>

<blockquote style="list-style-type:none;text-align:left;text-decoration:none;font-weight:normal;font-style:normal;border:medium none;color:rgb(17, 17, 17);background-color:rgb(245, 242, 240);border-radius:1em;font-family:Consolas, Monaco, &quot;Andale Mono&quot;, monospace;border-width:0.3em;border-color:rgb(224, 223, 204);border-style:solid;text-shadow:white 0px 1px;overflow:auto;margin:2em;padding:1em;"><pre style="margin:0px;list-style-type:none;text-decoration:none;font-weight:normal;font-style:normal;border:medium none;text-shadow:white 0px 1px;font-family:monospace, Consolas, Monaco, &quot;Andale Mono&quot;;direction:ltr;white-space:pre;word-spacing:normal;font-size:1.2em;hyphens:none;text-align:left;color:black;overflow:auto;padding:0em 0em 0.5em;background:rgb(245, 242, 240) none repeat scroll 0% 0%;" xml:space="preserve"><code style="margin:0px;padding:0px;list-style-type:none;text-decoration:none;font-weight:normal;font-style:normal;border:medium none;text-shadow:white 0px 1px;font-family:monospace, Consolas, Monaco, &quot;Andale Mono&quot;;direction:ltr;white-space:pre;word-spacing:normal;font-size:1.2em;hyphens:none;text-align:left;color:black;">
process<span style="margin:0px;padding:0px;list-style-type:none;text-align:left;text-decoration:none;font-weight:normal;font-style:normal;border:medium none;color:rgb(153, 153, 153);">.</span>stdin<span style="margin:0px;padding:0px;list-style-type:none;text-align:left;text-decoration:none;font-weight:normal;font-style:normal;border:medium none;color:rgb(153, 153, 153);">.</span><span style="margin:0px;padding:0px;list-style-type:none;text-align:left;text-decoration:none;font-weight:normal;font-style:normal;border:medium none;color:rgb(17, 17, 17);">setEncoding<span style="margin:0px;padding:0px;list-style-type:none;text-align:left;text-decoration:none;font-weight:normal;font-style:normal;border:medium none;color:rgb(153, 153, 153);">(</span></span><span style="margin:0px;padding:0px;list-style-type:none;text-align:left;text-decoration:none;font-weight:normal;font-style:normal;border:medium none;color:rgb(102, 153, 0);">'utf8'</span><span style="margin:0px;padding:0px;list-style-type:none;text-align:left;text-decoration:none;font-weight:normal;font-style:normal;border:medium none;color:rgb(153, 153, 153);">)</span><span style="margin:0px;padding:0px;list-style-type:none;text-align:left;text-decoration:none;font-weight:normal;font-style:normal;border:medium none;color:rgb(153, 153, 153);">;</span>

process<span style="margin:0px;padding:0px;list-style-type:none;text-align:left;text-decoration:none;font-weight:normal;font-style:normal;border:medium none;color:rgb(153, 153, 153);">.</span>stdin<span style="margin:0px;padding:0px;list-style-type:none;text-align:left;text-decoration:none;font-weight:normal;font-style:normal;border:medium none;color:rgb(153, 153, 153);">.</span><span style="margin:0px;padding:0px;list-style-type:none;text-align:left;text-decoration:none;font-weight:normal;font-style:normal;border:medium none;color:rgb(17, 17, 17);">on<span style="margin:0px;padding:0px;list-style-type:none;text-align:left;text-decoration:none;font-weight:normal;font-style:normal;border:medium none;color:rgb(153, 153, 153);">(</span></span><span style="margin:0px;padding:0px;list-style-type:none;text-align:left;text-decoration:none;font-weight:normal;font-style:normal;border:medium none;color:rgb(102, 153, 0);">'readable'</span><span style="margin:0px;padding:0px;list-style-type:none;text-align:left;text-decoration:none;font-weight:normal;font-style:normal;border:medium none;color:rgb(153, 153, 153);">,</span> <span style="margin:0px;padding:0px;list-style-type:none;text-align:left;text-decoration:none;font-weight:normal;font-style:normal;border:medium none;color:rgb(0, 119, 170);">function</span><span style="margin:0px;padding:0px;list-style-type:none;text-align:left;text-decoration:none;font-weight:normal;font-style:normal;border:medium none;color:rgb(153, 153, 153);">(</span><span style="margin:0px;padding:0px;list-style-type:none;text-align:left;text-decoration:none;font-weight:normal;font-style:normal;border:medium none;color:rgb(153, 153, 153);">)</span> <span style="margin:0px;padding:0px;list-style-type:none;text-align:left;text-decoration:none;font-weight:normal;font-style:normal;border:medium none;color:rgb(153, 153, 153);">{</span>
  <span style="margin:0px;padding:0px;list-style-type:none;text-align:left;text-decoration:none;font-weight:normal;font-style:normal;border:medium none;color:rgb(0, 119, 170);">var</span> chunk <span style="margin:0px;padding:0px;list-style-type:none;text-align:left;text-decoration:none;font-weight:normal;font-style:normal;border:medium none;background:rgba(255, 255, 255, 0.5) none repeat scroll 0% 0%;color:rgb(166, 127, 89);background-color:rgb(204, 232, 207);">=</span> process<span style="margin:0px;padding:0px;list-style-type:none;text-align:left;text-decoration:none;font-weight:normal;font-style:normal;border:medium none;color:rgb(153, 153, 153);">.</span>stdin<span style="margin:0px;padding:0px;list-style-type:none;text-align:left;text-decoration:none;font-weight:normal;font-style:normal;border:medium none;color:rgb(153, 153, 153);">.</span><span style="margin:0px;padding:0px;list-style-type:none;text-align:left;text-decoration:none;font-weight:normal;font-style:normal;border:medium none;color:rgb(17, 17, 17);">read<span style="margin:0px;padding:0px;list-style-type:none;text-align:left;text-decoration:none;font-weight:normal;font-style:normal;border:medium none;color:rgb(153, 153, 153);">(</span></span><span style="margin:0px;padding:0px;list-style-type:none;text-align:left;text-decoration:none;font-weight:normal;font-style:normal;border:medium none;color:rgb(153, 153, 153);">)</span><span style="margin:0px;padding:0px;list-style-type:none;text-align:left;text-decoration:none;font-weight:normal;font-style:normal;border:medium none;color:rgb(153, 153, 153);">;</span>
  <span style="margin:0px;padding:0px;list-style-type:none;text-align:left;text-decoration:none;font-weight:normal;font-style:normal;border:medium none;color:rgb(0, 119, 170);">if</span> <span style="margin:0px;padding:0px;list-style-type:none;text-align:left;text-decoration:none;font-weight:normal;font-style:normal;border:medium none;color:rgb(153, 153, 153);">(</span>chunk <span style="margin:0px;padding:0px;list-style-type:none;text-align:left;text-decoration:none;font-weight:normal;font-style:normal;border:medium none;background:rgba(255, 255, 255, 0.5) none repeat scroll 0% 0%;color:rgb(166, 127, 89);background-color:rgb(204, 232, 207);">!</span><span style="margin:0px;padding:0px;list-style-type:none;text-align:left;text-decoration:none;font-weight:normal;font-style:normal;border:medium none;background:rgba(255, 255, 255, 0.5) none repeat scroll 0% 0%;color:rgb(166, 127, 89);background-color:rgb(204, 232, 207);">==</span> <span style="margin:0px;padding:0px;list-style-type:none;text-align:left;text-decoration:none;font-weight:normal;font-style:normal;border:medium none;color:rgb(0, 119, 170);">null</span><span style="margin:0px;padding:0px;list-style-type:none;text-align:left;text-decoration:none;font-weight:normal;font-style:normal;border:medium none;color:rgb(153, 153, 153);">)</span> <span style="margin:0px;padding:0px;list-style-type:none;text-align:left;text-decoration:none;font-weight:normal;font-style:normal;border:medium none;color:rgb(153, 153, 153);">{</span>
    process<span style="margin:0px;padding:0px;list-style-type:none;text-align:left;text-decoration:none;font-weight:normal;font-style:normal;border:medium none;color:rgb(153, 153, 153);">.</span>stdout<span style="margin:0px;padding:0px;list-style-type:none;text-align:left;text-decoration:none;font-weight:normal;font-style:normal;border:medium none;color:rgb(153, 153, 153);">.</span><span style="margin:0px;padding:0px;list-style-type:none;text-align:left;text-decoration:none;font-weight:normal;font-style:normal;border:medium none;color:rgb(17, 17, 17);">write<span style="margin:0px;padding:0px;list-style-type:none;text-align:left;text-decoration:none;font-weight:normal;font-style:normal;border:medium none;color:rgb(153, 153, 153);">(</span></span><span style="margin:0px;padding:0px;list-style-type:none;text-align:left;text-decoration:none;font-weight:normal;font-style:normal;border:medium none;color:rgb(102, 153, 0);">'data: '</span> <span style="margin:0px;padding:0px;list-style-type:none;text-align:left;text-decoration:none;font-weight:normal;font-style:normal;border:medium none;background:rgba(255, 255, 255, 0.5) none repeat scroll 0% 0%;color:rgb(166, 127, 89);background-color:rgb(204, 232, 207);">+</span> chunk<span style="margin:0px;padding:0px;list-style-type:none;text-align:left;text-decoration:none;font-weight:normal;font-style:normal;border:medium none;color:rgb(153, 153, 153);">)</span><span style="margin:0px;padding:0px;list-style-type:none;text-align:left;text-decoration:none;font-weight:normal;font-style:normal;border:medium none;color:rgb(153, 153, 153);">;</span>
  <span style="margin:0px;padding:0px;list-style-type:none;text-align:left;text-decoration:none;font-weight:normal;font-style:normal;border:medium none;color:rgb(153, 153, 153);">}</span>
<span style="margin:0px;padding:0px;list-style-type:none;text-align:left;text-decoration:none;font-weight:normal;font-style:normal;border:medium none;color:rgb(153, 153, 153);">}</span><span style="margin:0px;padding:0px;list-style-type:none;text-align:left;text-decoration:none;font-weight:normal;font-style:normal;border:medium none;color:rgb(153, 153, 153);">)</span><span style="margin:0px;padding:0px;list-style-type:none;text-align:left;text-decoration:none;font-weight:normal;font-style:normal;border:medium none;color:rgb(153, 153, 153);">;</span>
</code></pre></blockquote>

<p style="margin:0px;padding:0px;list-style-type:none;text-align:left;text-decoration:none;font-weight:normal;font-style:normal;border:medium none;color:rgb(17, 17, 17);font-size:1.6em;margin-top:1em;margin-left:0.8em;line-height:180%;">启动这个脚本的命令如下。</p>

<blockquote style="list-style-type:none;text-align:left;text-decoration:none;font-weight:normal;font-style:normal;border:medium none;color:rgb(17, 17, 17);background-color:rgb(245, 242, 240);border-radius:1em;font-family:Consolas, Monaco, &quot;Andale Mono&quot;, monospace;border-width:0.3em;border-color:rgb(224, 223, 204);border-style:solid;text-shadow:white 0px 1px;overflow:auto;margin:2em;padding:1em;"><pre style="margin:0px;list-style-type:none;text-decoration:none;font-weight:normal;font-style:normal;border:medium none;text-shadow:white 0px 1px;font-family:monospace, Consolas, Monaco, &quot;Andale Mono&quot;;direction:ltr;white-space:pre;word-spacing:normal;font-size:1.2em;hyphens:none;text-align:left;color:black;overflow:auto;padding:0em 0em 0.5em;background:rgb(245, 242, 240) none repeat scroll 0% 0%;" xml:space="preserve"><code style="margin:0px;padding:0px;list-style-type:none;text-decoration:none;font-weight:normal;font-style:normal;border:medium none;text-shadow:white 0px 1px;font-family:monospace, Consolas, Monaco, &quot;Andale Mono&quot;;direction:ltr;white-space:pre;word-spacing:normal;font-size:1.2em;hyphens:none;text-align:left;color:black;">
$ websocketd <span style="margin:0px;padding:0px;list-style-type:none;text-align:left;text-decoration:none;font-weight:normal;font-style:normal;border:medium none;background:rgba(255, 255, 255, 0.5) none repeat scroll 0% 0%;color:rgb(166, 127, 89);background-color:rgb(204, 232, 207);">--</span>port<span style="margin:0px;padding:0px;list-style-type:none;text-align:left;text-decoration:none;font-weight:normal;font-style:normal;border:medium none;background:rgba(255, 255, 255, 0.5) none repeat scroll 0% 0%;color:rgb(166, 127, 89);background-color:rgb(204, 232, 207);">=</span><span style="margin:0px;padding:0px;list-style-type:none;text-align:left;text-decoration:none;font-weight:normal;font-style:normal;border:medium none;color:rgb(153, 0, 85);">8080</span> node <span style="margin:0px;padding:0px;list-style-type:none;text-align:left;text-decoration:none;font-weight:normal;font-style:normal;border:medium none;color:rgb(153, 153, 153);">.</span><span style="margin:0px;padding:0px;list-style-type:none;text-align:left;text-decoration:none;font-weight:normal;font-style:normal;border:medium none;background:rgba(255, 255, 255, 0.5) none repeat scroll 0% 0%;color:rgb(166, 127, 89);background-color:rgb(204, 232, 207);">/</span>greeter<span style="margin:0px;padding:0px;list-style-type:none;text-align:left;text-decoration:none;font-weight:normal;font-style:normal;border:medium none;color:rgb(153, 153, 153);">.</span>js
</code></pre></blockquote>

<p style="margin:0px;padding:0px;list-style-type:none;text-align:left;text-decoration:none;font-weight:normal;font-style:normal;border:medium none;color:rgb(17, 17, 17);font-size:1.6em;margin-top:1em;margin-left:0.8em;line-height:180%;">官方仓库还有其他<a href="https://github.com/joewalnes/websocketd/tree/master/examples" target="_blank" style="margin:0px;padding:0px;list-style-type:none;text-align:left;font-weight:normal;font-style:normal;border:medium none;text-decoration:underline;color:rgb(34, 52, 114);">各种语言</a>的例子。</p>

<h2 style="list-style-type:none;text-align:left;text-decoration:none;font-style:normal;border:medium none;font-size:2.88em;line-height:1.35em;letter-spacing:-0.03em;border-bottom:1px solid rgb(211, 211, 211);margin:0.4em 0px 0.2em;padding:0px 0px 0.2em;font-weight:500;color:rgb(0, 0, 0);margin-top:1.5em;">七、参考链接</h2>

<ul style="margin:0px;padding:0px;list-style-type:none;text-align:left;text-decoration:none;font-weight:normal;font-style:normal;border:medium none;color:rgb(17, 17, 17);margin-left:4em;">
<li style="margin:0px;padding:0px;text-align:left;text-decoration:none;font-weight:normal;font-style:normal;border:medium none;color:rgb(17, 17, 17);font-size:1.6em;line-height:220%;list-style-type:square;"><a href="http://cjihrig.com/blog/how-to-use-websockets/" target="_blank" style="margin:0px;padding:0px;list-style-type:none;text-align:left;font-weight:normal;font-style:normal;border:medium none;text-decoration:underline;color:rgb(34, 52, 114);">How to Use WebSockets</a></li>
<li style="margin:0px;padding:0px;text-align:left;text-decoration:none;font-weight:normal;font-style:normal;border:medium none;color:rgb(17, 17, 17);font-size:1.6em;line-height:220%;list-style-type:square;"><a href="https://www.tutorialspoint.com/websockets/websockets_send_receive_messages.htm" target="_blank" style="margin:0px;padding:0px;list-style-type:none;text-align:left;font-weight:normal;font-style:normal;border:medium none;text-decoration:underline;color:rgb(34, 52, 114);">WebSockets - Send &amp; Receive Messages</a></li>
<li style="margin:0px;padding:0px;text-align:left;text-decoration:none;font-weight:normal;font-style:normal;border:medium none;color:rgb(17, 17, 17);font-size:1.6em;line-height:220%;list-style-type:square;"><a href="https://www.html5rocks.com/en/tutorials/websockets/basics/" target="_blank" style="margin:0px;padding:0px;list-style-type:none;text-align:left;font-weight:normal;font-style:normal;border:medium none;text-decoration:underline;color:rgb(34, 52, 114);">Introducing WebSockets: Bringing Sockets to the Web</a></li>
</ul>

<p style="margin:0px;padding:0px;list-style-type:none;text-align:left;text-decoration:none;font-weight:normal;font-style:normal;border:medium none;color:rgb(17, 17, 17);font-size:1.6em;margin-top:1em;margin-left:0.8em;line-height:180%;">（完）</p>

                                    

                                </div>
    
                                <div style="list-style-type:none;text-align:left;text-decoration:none;font-style:normal;border-radius:1em;box-shadow:rgb(238, 238, 238) 0px 1px 0px 0px inset;background:rgb(170, 210, 240) linear-gradient(rgb(170, 210, 240) 5%, rgb(139, 193, 237) 100%) repeat scroll 0% 0%;text-shadow:rgb(238, 238, 238) 1px 1px 0px;margin:0px 0px 1em;font-weight:bold;color:rgb(252, 178, 151);margin-top:2em;background-color:rgb(222, 235, 247);padding:1.5em;border:1px solid rgb(211, 211, 211);">

<h3 style="list-style-type:none;text-align:left;text-decoration:none;font-style:normal;border:medium none;letter-spacing:-0.03em;margin:0.4em 0px 0.2em;padding:0px 0px 0.2em;font-weight:bold;color:rgb(85, 102, 119);font-size:1.92em;border-bottom:1px solid gray;">文档信息</h3>
<ul style="margin:0px;padding:0px;list-style-type:none;text-align:left;text-decoration:none;font-weight:normal;font-style:normal;border:medium none;color:rgb(17, 17, 17);padding-left:2em;padding-right:2em;">
<li style="margin:0px;padding:0px;text-align:left;text-decoration:none;font-weight:normal;font-style:normal;border:medium none;font-size:1.6em;line-height:220%;list-style-type:square;color:rgb(85, 102, 119);">版权声明：自由转载-非商用-非衍生-保持署名（<a href="http://creativecommons.org/licenses/by-nc-nd/3.0/deed.zh" style="margin:0px;padding:0px;list-style-type:none;text-align:left;text-decoration:none;font-weight:normal;font-style:normal;border:medium none;color:rgb(85, 102, 119);">创意共享3.0许可证</a>）</li>
<li style="margin:0px;padding:0px;text-align:left;text-decoration:none;font-weight:normal;font-style:normal;border:medium none;font-size:1.6em;line-height:220%;list-style-type:square;color:rgb(85, 102, 119);">发表日期： <abbr title="2017-05-15T08:39:57+08:00" style="margin:0px;padding:0px;list-style-type:none;text-align:left;text-decoration:none;font-weight:normal;font-style:normal;border:medium none;color:rgb(61, 61, 61);">2017年5月15日</abbr></li>

</ul>
                                </div>
</div></div></div></div></div></div></div></div></div></div></div>
</div>
</div></body></html>
  </div>
</div>



  <footer class="site-footer">


    <div class="wrapper">

        <p class="description">
            
        </p>
        <p class="contact">
            Contact me at: 
            <a href="https://github.com/tldsn" title="GitHub"><i class="fa fa-github" aria-hidden="true"></i></a>  
            <a href="http://mail.qq.com/cgi-bin/qm_share?t=qm_mailme&email=742720531@qq.com" title="email"><i class="fa fa-envelope-o" aria-hidden="true"></i></a>  
            <a href="http://weibo.com/5578237033" title="Weibo"><i class="fa fa-weibo" aria-hidden="true"></i></a>  
            <a href="https://www.zhihu.com/people/yao-yu-jie-90" title="Zhihu"><i class="iconfont blog-zhihu"></i></a>  
            <a href="https://www.douban.com/people/122400251" title="Douban"><i class="iconfont blog-douban"></i></a>  
            <a href="https://music.163.com/#/user/home?id=263386850" title="Cloudmusic"><i class="iconfont blog-yinle"></i></a>  
             
               
            
        </p>
        <p class="busuanzi">
            本站总访问量<span id="busuanzi_value_site_pv"></span>次，本站访客数<span id="busuanzi_value_site_uv"></span>人次，本文总阅读量<span id="busuanzi_value_page_pv"></span>次
        </p>
        <p class="power">
            <span>
                Site powered by <a href="https://jekyllrb.com/">Jekyll</a> & <a href="https://pages.github.com/">Github Pages</a>.
            </span>
            <span>
                Theme designed by <a href="https://github.com/Gaohaoyang">HyG</a>.
            </span>
        </p>
    </div>
</footer>
<script async src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script>

  <div class="back-to-top">
    <a href="#top" data-scroll>
        <i class="fa fa-arrow-up" aria-hidden="true"></i>
    </a>
</div>

  <div id="music"></div>

  <!-- 加载 cplayer 脚本 -->
  <!-- <script src="https://cdn.jsdelivr.net/npm/cplayer/dist/cplayer.min.js"></script>
  <script>
    let player = new cplayer({
      element: document.getElementById('music'),
      playlist: [
      ]
    })

    cplayer.prototype.add163 = function add163(id) {
      if (!id) throw new Error("Unable Property.");
      return fetch("https://music.huaji8.top/?id=" + id).then(function (res) { return res.json() }).then(function (data) {
        let obj = {
          name: data.info.songs[0].name,
          artist: data.info.songs[0].ar.map(function (ar) { return ar.name }).join(','),
          poster: data.pic.url,
          lyric: data.lyric.lyric,
          sublyric: data.lyric.tlyric,
          src: data.url.url,
          album: data.info.songs[0].al.name
        }
        this.add(obj);
        return obj;
      }.bind(this))
    }
    player.add163(263386850)
  </script> -->
  <script src=" /assets/js/main.js " charset="utf-8"></script>
  <script src=" /assets/js/smooth-scroll.min.js " charset="utf-8"></script>
  <script type="text/javascript">
    smoothScroll.init({
      speed: 500, // Integer. How fast to complete the scroll in milliseconds
      easing: 'easeInOutCubic', // Easing pattern to use
      offset: 20, // Integer. How far to offset the scrolling anchor location in pixels
    });
  </script>
  <!-- <script src=" /assets/js/scroll.min.js " charset="utf-8"></script> -->
</body>

</html>